<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:epub="http://www.idpf.org/2007/ops" xmlns:m="http://www.w3.org/1998/Math/MathML" xmlns:pls="http://www.w3.org/2005/01/pronunciation-lexicon" xmlns:ssml="http://www.w3.org/2001/10/synthesis" xmlns:svg="http://www.w3.org/2000/svg">
<head>
  <meta charset="UTF-8" />
  <title>2 Object Orientation</title>
  <link type="text/css" rel="stylesheet" media="all" href="style.css" />
  <link type="text/css" rel="stylesheet" media="all" href="core.css" />
</head>
<body>
  <div id="sbo-rt-content"><section epub:type="chapter">
<p class="image"><img src="images/common-01.jpg" alt="Images" /></p>
<h2 class="h2p" id="ch2"><span id="page_69" epub:type="pagebreak"></span><strong>2</strong></h2>
<h2 class="h2p1"><strong>Object Orientation</strong></h2>
<p class="title-o"><span class="white"><strong>CERTIFICATION OBJECTIVES</strong></span></p>
<p class="toc-l">•       Implement Encapsulation</p>
<p class="toc-l">•       Implement Inheritance</p>
<p class="toc-l">•       Use IS-A and HAS-A Relationships</p>
<p class="toc-l">•       Use Polymorphism</p>
<p class="toc-l">•       Use Overriding and Overloading</p>
<p class="toc-l">•       Use the @Override Annotation</p>
<p class="toc-l">•       Understand Casting</p>
<p class="toc-l">•       Use Interfaces</p>
<p class="toc-l">•       Understand and Use Return Types</p>
<p class="toc-l">•       Develop Constructors</p>
<p class="toc-l">•       Use the Singleton Pattern</p>
<p class="toc-l">•       Develop Immutable Classes</p>
<p class="toc-l">•       Use static Members</p>
<p class="toc-lq"><img src="images/tick.jpg" alt="Images" />     Two-Minute Drill</p>
<p class="toc-q"><strong>Q&amp;A</strong>   Self Test</p>
<p class="noindent-d"><span id="page_70" epub:type="pagebreak"></span><span class="dropcap"><strong>T</strong></span>his chapter will prepare you for many of the object-oriented objectives and questions you’ll encounter on the exam. As with <a href="ch1.xhtml#ch1">Chapter 1</a>, most of this chapter is a refresher of some of the topics you learned while studying for the OCA 8 exam. Apart from the discussions of the @Override annotation, the singleton pattern, and immutable classes, if you feel you mastered the OCA 8 section 6 objectives (Working with Methods and Encapsulation) and the section 7 objectives (Working with Inheritance) while studying for the OCA 8, you might be able to skip this chapter. If you’re not sure, try your hand at the Self Test at the end of the chapter.</p>
<p class="title-o"><span class="white"><strong>CERTIFICATION OBJECTIVE</strong></span></p>
<h3 class="h3" id="ch2lev1sec1"><strong>Encapsulation (OCP Objective 1.1)</strong></h3>
<p class="noindentb"><em>1.1   Implement encapsulation.</em></p>
<p class="indent">Imagine you wrote the code for a class and another dozen programmers from your company all wrote programs that used your class. Now imagine that later on, you didn’t like the way the class behaved, because some of its instance variables were being set (by the other programmers from within their code) to values you hadn’t anticipated. <em>Their</em> code brought out errors in <em>your</em> code. (Relax, this is just hypothetical.) Well, it is a Java program, so you should be able to ship out a newer version of the class, which they could replace in their programs without changing any of their own code.</p>
<p class="indent">This scenario highlights two of the promises/benefits of an object-oriented (OO) language: flexibility and maintainability. But those benefits don’t come automatically. You have to do something. You have to write your classes and code in a way that supports flexibility and maintainability. So what if Java supports OO? It can’t design your code for you. For example, imagine you made your class with <code>public</code> instance variables, and those other programmers were setting the instance variables directly, as the following code demonstrates:</p>
<p class="pre"><img src="images/un070-01.jpg" alt="Images" /></p>
<p class="pre"><span id="page_71" epub:type="pagebreak"></span><img src="images/un071-01.jpg" alt="Images" /></p>
<p class="indent">And now you’re in trouble. How are you going to change the class in a way that lets you handle the issues that come up when somebody changes the <code>size</code> variable to a value that causes problems? Your only choice is to go back in and write method code for adjusting <code>size</code> (a <code>setSize(int a)</code> method, for example) and then insulate the <code>size</code> variable with, say, a private access modifier. But as soon as you make that change to your code, you break everyone else’s!</p>
<p class="indent">The ability to make changes in your implementation code without breaking the code of others who use your code is a key benefit of encapsulation. You want to hide implementation details behind a public programming interface. By <em>interface,</em> we mean the set of accessible methods your code makes available for other code to call—in other words, your code’s API. By hiding implementation details, you can rework your method code (perhaps also altering the way variables are used by your class) without forcing a change in the code that calls your changed method.</p>
<p class="indent">If you want maintainability, flexibility, and extensibility (and, of course, you do), your design must include encapsulation. How do you do that?</p>
<p class="bullt"><img class="inline" src="images/box.jpg" alt="Images" />   Keep instance variables hidden (with an access modifier, often <code>private</code>).</p>
<p class="bull"><img class="inline" src="images/box.jpg" alt="Images" />   Make <code>public</code> accessor methods, and force calling code to use those methods rather than directly accessing the instance variable. These so-called accessor methods allow users of your class to <strong>set</strong> a variable’s value or <strong>get</strong> a variable’s value.</p>
<p class="bullb"><img class="inline" src="images/box.jpg" alt="Images" />   For these accessor methods, use the most common naming convention of <code>set&lt;SomeProperty&gt;</code> and <code>get&lt;SomeProperty&gt;</code>.</p>
<p class="indent"><a href="ch2.xhtml#ch2fig1">Figure 2-1</a> illustrates the idea that encapsulation forces callers of our code to go through methods rather than accessing variables directly.</p>
<p class="figcap" id="ch2fig1"><span class="figure"><strong>FIGURE 2-1</strong></span></p>
<p class="figcap1">The nature of encapsulation</p>
<p class="imagef"><img src="images/fig02-01.jpg" alt="Images" /></p>
<p class="indent">We call the access methods <em>getters</em> and <em>setters,</em> although some prefer the fancier terms <em>accessors</em> and <em>mutators</em>. (Personally, we don’t like the word “mutate.“) Regardless of what you call them, they’re methods that other programmers must <span id="page_72" epub:type="pagebreak"></span>go through in order to access your instance variables. They look simple, and you’ve probably been using them forever:</p>
<p class="pre"><img src="images/un072-01.jpg" alt="Images" /></p>
<p class="pre"><span id="page_73" epub:type="pagebreak"></span><img src="images/un073-01.jpg" alt="Images" /></p>
<p class="indent">Wait a minute. How useful is the previous code? It doesn’t even do any validation or processing. What benefit can there be from having getters and setters that add no functionality? The point is, you can change your mind later and add more code to your methods without breaking your API. Even if today you don’t think you really need validation or processing of the data, good OO design dictates that you plan for the future. To be safe, force calling code to go through your methods rather than going directly to instance variables. <em>Always</em>. Then you’re free to rework your method implementations later, without risking the wrath of those dozen programmers who know where you live.</p>
<div class="side">
<p class="exam"><img src="images/exam.jpg" alt="Images" /></p>
</div>
<div class="side1">
<p class="indentb"><strong><em>Look out for code that appears to be asking about the behavior of a method, when the problem is actually a lack of encapsulation. Look at the following example, and see if you can figure out what’s going on:</em></strong></p>
<p class="noindentb"><img src="images/un073-02.jpg" alt="Images" /></p>
<p class="noindent"><strong><em>Now consider this question: Is the value of right always going to be one-third the value of left? It looks like it will, until you realize that users of the <code>Foo</code> class don’t need to use the <code>setLeft()</code> method! They can simply go straight to the instance variables and change them to any arbitrary int value.</em></strong></p>
</div>
<p class="title-o"><span id="page_74" epub:type="pagebreak"></span><span class="white"><strong>CERTIFICATION OBJECTIVE</strong></span></p>
<h3 class="h3" id="ch2lev1sec2"><strong>Inheritance and Polymorphism (OCP Objectives 1.2 and 1.3)</strong></h3>
<p class="noindent"><em>1.2   Implement inheritance including visibility modifiers and composition.</em></p>
<p class="noindentb"><em>1.3   Implement polymorphism.</em></p>
<p class="indent">Inheritance is everywhere in Java. It’s safe to say that it’s almost (almost?) impossible to write even the tiniest Java program without using inheritance. To explore this topic, we’re going to use the <code>instanceof</code> operator. This code:</p>
<p class="pre"><img src="images/un074-01.jpg" alt="Images" /></p>
<p class="noindent">produces this output:</p>
<p class="pre"><img src="images/un074-02.jpg" alt="Images" /></p>
<p class="indent">Where did that <code>equals</code> method come from? The reference variable <code>t1</code> is of type <code>Test</code>, and there’s no <code>equals</code> method in the <code>Test</code> class. Or is there? The second <code>if</code> test asks whether <code>t1</code> is an instance of class <code>Object</code>, and because it <em>is</em> (more on that soon), the <code>if</code> test succeeds.</p>
<p class="indent">Hold on…how can <code>t1</code> be an instance of type <code>Object</code>, when we just said it was of type <code>Test</code>? I’m sure you’re way ahead of us here, but it turns out that every class in Java is a subclass of class <code>Object</code> (except, of course, class <code>Object</code> itself). In other words, every class you’ll ever use or ever write will inherit from class <code>Object</code>. You’ll always have an <code>equals</code> method, <code>notify</code> and <code>wait</code> methods, and others available to use. Whenever you create a class, you automatically inherit all of class <code>Object</code>’s methods.</p>
<p class="indent"><span id="page_75" epub:type="pagebreak"></span>Why? Let’s look at that <code>equals</code> method, for instance. Java’s creators correctly assumed that it would be common for Java programmers to want to compare instances of their classes to check for equality. If class <code>Object</code> didn’t have an <code>equals</code> method, you’d have to write one yourself—you and every other Java programmer. That one <code>equals</code> method has been inherited billions of times. (To be fair, <code>equals</code> has also been <em>overridden</em> billions of times, but we’re getting ahead of ourselves.)</p>
<h4 class="h4" id="ch2lev2sec1"><strong>The Evolution of Inheritance</strong></h4>
<p class="noindent">Until Java 8, when the topic of inheritance was discussed, it usually revolved around subclasses inheriting methods from their superclasses. While this simplification was never perfectly correct, it became less correct with the new features available in Java 8. As <a href="ch2.xhtml#ch2tab1">Table 2-1</a> shows, it’s now possible to inherit concrete methods from interfaces. This is a big change. For the rest of the chapter, when we talk about inheritance generally, we will tend to use the terms “subtypes” and “supertypes” to acknowledge that both classes and interfaces need to be accounted for. We will tend to use the terms “subclass” and “superclass” when we’re discussing a specific example that’s under discussion. Inheritance is a key aspect of most of the topics we’ll be discussing in this chapter, so be prepared for LOTS of discussion about the interactions between supertypes and subtypes!</p>
<p class="tabcap" id="ch2tab1"><span class="table"><strong>TABLE 2-1</strong></span> Inheritable Elements of Classes and Interfaces</p>
<p class="imaget"><img src="images/tab02-01.jpg" alt="Images" /></p>
<p class="indent">As you study <a href="ch2.xhtml#ch2tab1">Table 2-1</a>, you’ll notice that, as of Java 8, interfaces can contain two types of concrete methods: <code>static</code> and <code>default</code>. We’ll discuss these important additions later in this chapter.</p>
<p class="indent"><a href="ch2.xhtml#ch2tab1">Table 2-1</a> summarizes the elements of classes and interfaces relative to inheritance.</p>
<p class="indent"><span id="page_76" epub:type="pagebreak"></span>For the exam, you’ll need to know that you can create inheritance relationships in Java by <em>extending</em> a class or by implementing an interface. It’s also important to understand that the two most common reasons to use inheritance are</p>
<p class="bullt"><img class="inline" src="images/box.jpg" alt="Images" />   To promote code reuse</p>
<p class="bullb"><img class="inline" src="images/box.jpg" alt="Images" />   To use polymorphism</p>
<p class="indent">Let’s start with reuse. A common design approach is to create a fairly generic version of a class with the intention of creating more specialized subclasses that inherit from it. For example:</p>
<p class="pre"><img src="images/un076-01.jpg" alt="Images" /></p>
<p class="indent">Notice that the <code>PlayerPiece</code> class inherits the generic <code>displayShape()</code> method from the less-specialized class <code>GameShape</code> and also adds its own method, <code>movePiece()</code>. Code reuse through inheritance means that methods with generic functionality—such as <code>displayShape()</code>, which could apply to a wide range of different kinds of shapes in a game—don’t have to be reimplemented. That means all specialized subclasses of <code>GameShape</code> are guaranteed to have the <span id="page_77" epub:type="pagebreak"></span>capabilities of the more general superclass. You don’t want to have to rewrite the <code>displayShape()</code> code in each of your specialized components of an online game.</p>
<p class="indent">But you knew that. You’ve experienced the pain of duplicate code when you make a change in one place and have to track down all the other places where that same (or very similar) code exists.</p>
<p class="indent">The second (and related) use of inheritance is to allow your classes to be accessed polymorphically—a capability provided by interfaces as well, but we’ll get to that in a minute. Let’s say that you have a <code>GameLauncher</code> class that wants to loop through a list of different kinds of <code>GameShape</code> objects and invoke <code>displayShape()</code> on each of them. At the time you write this class, you don’t know every possible kind of <code>GameShape</code> subclass that anyone else will ever write. And you sure don’t want to have to redo <em>your</em> code just because somebody decided to build a dice shape six months later.</p>
<p class="indent">The beautiful thing about polymorphism (“many forms“) is that you can treat any <em>subclass</em> of <code>GameShape</code> as a <code>GameShape</code>. In other words, you can write code in your <code>GameLauncher</code> class that says, “I don’t care what kind of object you are as long as you inherit from (extend) <code>GameShape</code>. And as far as I’m concerned, if you extend <code>GameShape</code>, then you’ve definitely got a <code>displayShape()</code> method, so I know I can call it.“</p>
<p class="indent">Imagine we now have two specialized subclasses that extend the more generic <code>GameShape</code> class, <code>PlayerPiece</code> and <code>TilePiece</code>:</p>
<p class="pre"><img src="images/un077-01.jpg" alt="Images" /></p>
<p class="indent"><span id="page_78" epub:type="pagebreak"></span>Now imagine a test class has a method with a declared argument type of <code>GameShape</code>, which means it can take any kind of <code>GameShape</code>. In other words, any subclass of <code>GameShape</code> can be passed to a method with an argument of type <code>GameShape</code>. This code:</p>
<p class="pre"><img src="images/un078-01.jpg" alt="Images" /></p>
<p class="indent">The key point is that the <code>doShapes()</code> method is declared with a <code>GameShape</code> argument but can be passed any subtype (in this example, a subclass) of <code>GameShape</code>. The method can then invoke any method of <code>GameShape</code>, without any concern for the actual runtime class type of the object passed to the method. There are implications, though. The <code>doShapes()</code> method knows only that the objects are a type of <code>GameShape</code> since that’s how the parameter is declared. And using a reference variable declared as type <code>GameShape</code>—regardless of whether the variable is a method parameter, local variable, or instance variable—means that <em>only </em>the methods of <code>GameShape</code> can be invoked on it. The methods you can call on a reference are totally dependent on the <em>declared</em> type of the variable, no matter what the actual object is, that the reference is referring to. That means you can’t use a <code>GameShape</code> variable to call, say, the <code>getAdjacent()</code> method even if the object passed in <em>is</em> of type <code>TilePiece</code>. (We’ll see this again when we look at interfaces.)</p>
<h4 class="h4" id="ch2lev2sec2"><strong>IS-A and HAS-A Relationships</strong></h4>
<p class="noindent">Note: As of early 2018, the OCP 8 exam doesn’t mention IS-A and HAS-A relationships explicitly, but inheritance and polymorphism are all about IS-A relationships, and composition is another way of saying “HAS-A.“</p>
<h5 class="h5"><span id="page_79" epub:type="pagebreak"></span>IS-A</h5>
<p class="noindent">In OO, the concept of IS-A is based on inheritance (or interface implementation). IS-A is a way of saying, “This thing is a type of that thing.” For example, a Mustang is a type of Horse, so in OO terms we can say, “Mustang IS-A Horse.” Subaru IS-A Car. Broccoli IS-A Vegetable (not a very fun one, but it still counts). You express the IS-A relationship in Java through the keywords <code>extends</code> (for <em>class</em> inheritance) and <code>implements</code> (for <em>interface</em> implementation).</p>
<p class="pre"><img src="images/un079-01.jpg" alt="Images" /></p>
<p class="indent">A Car is a type of Vehicle, so the inheritance tree might start from the <code>Vehicle</code> class as follows:</p>
<p class="pre"><img src="images/un079-02.jpg" alt="Images" /></p>
<p class="indentb">In OO terms, you can say the following:</p>
<p class="indent"><code>Vehicle</code> is a superclass of <code>Car.</code></p>
<p class="indent"><code>Car</code> is a subclass of <code>Vehicle.</code></p>
<p class="indent"><code>Car</code> is a superclass of <code>Subaru.</code></p>
<p class="indent"><code>Subaru</code> is a subclass of <code>Vehicle.</code></p>
<p class="indent"><code>Car</code> inherits from <code>Vehicle.</code></p>
<p class="indent"><code>Subaru</code> inherits from both <code>Vehicle</code> and <code>Car.</code></p>
<p class="indent"><code>Subaru</code> is derived from <code>Car.</code></p>
<p class="indent"><code>Car</code> is derived from <code>Vehicle.</code></p>
<p class="indent"><code>Subaru</code> is derived from <code>Vehicle.</code></p>
<p class="indentb"><code>Subaru</code> is a subtype of both <code>Vehicle</code> and <code>Car.</code></p>
<p class="indentb">Returning to our IS-A relationship, the following statements are true:</p>
<p class="indent"><code>"Car</code> extends <code>Vehicle"</code> means <code>"Car</code> IS-A <code>Vehicle."</code></p>
<p class="indentb"><code>"Subaru</code> extends <code>Car"</code> means <code>"Subaru</code> IS-A <code>Car."</code></p>
<p class="noindentb">And we can also say:</p>
<p class="indentb">“Subaru IS-A Vehicle“</p>
<p class="noindent"><span id="page_80" epub:type="pagebreak"></span>because a class is said to be “a type of” anything further up in its inheritance tree. If the expression (<code>Foo instanceof Bar)</code> is <code>true</code>, then class <code>Foo</code> IS-A <code>Bar</code>, even if <code>Foo</code> doesn’t directly extend <code>Bar</code>, but instead extends some other class that is a subclass of <code>Bar</code>. <a href="ch2.xhtml#ch2fig2">Figure 2-2</a> illustrates the inheritance tree for <code>Vehicle</code>, <code>Car</code>, and <code>Subaru</code>. The arrows move from the subclass to the superclass. In other words, a class’s arrow points toward the class from which it extends.</p>
<p class="figcap" id="ch2fig2"><span class="figure"><strong>FIGURE 2-2</strong></span></p>
<p class="figcap">Inheritance tree for <code>Vehicle, Car, Subaru</code></p>
<p class="imagef"><img src="images/fig02-02.jpg" alt="Images" /></p>
<h5 class="h5">HAS-A</h5>
<p class="noindent">HAS-A relationships are based on use, rather than inheritance. In other words, class A HAS-A B if code in class A has a reference to an instance of class B. For example, you can say the following:</p>
<p class="indenttb">A <code>Horse</code> IS-A <code>Animal</code>. A <code>Horse</code> HAS-A <code>Halter</code>.</p>
<p class="noindent">The code might look like this:</p>
<p class="pre"><img src="images/un080-01.jpg" alt="Images" /></p>
<p class="noindent">In this code, the <code>Horse</code> class has an instance variable of type <code>Halter</code> (a halter is a piece of gear you might have if you have a horse), so you can say that a “<code>Horse</code> HAS-A <code>Halter</code>.” In other words, <code>Horse</code> has a reference to a <code>Halter</code>. <code>Horse</code> code can use that <code>Halter</code> reference to invoke methods on the <code>Halter</code> and get <code>Halter</code> behavior without having <code>Halter</code>-related code (methods) in the <code>Horse</code> class itself. <a href="ch2.xhtml#ch2fig3">Figure 2-3</a> illustrates the HAS-A relationship between <code>Horse</code> and <code>Halter</code>.</p>
<p class="figcap" id="ch2fig3"><span id="page_81" epub:type="pagebreak"></span><span class="figure"><strong>FIGURE 2-3</strong></span></p>
<p class="figcap1">HAS-A relationship between <code>Horse</code> and <code>Halter</code></p>
<p class="imagef"><img src="images/fig02-03.jpg" alt="Images" /></p>
<p class="indent">HAS-A relationships allow you to design classes that follow good OO practices by not having monolithic classes that do a gazillion different things. Classes (and their resulting objects) should be specialists. As our friend Andrew says, “Specialized classes can actually help reduce bugs.” The more specialized the class, the more likely it is that you can reuse the class in other applications. If you put all the <code>Halter</code>-related code directly into the <code>Horse</code> class, you’ll end up duplicating code in the <code>Cow</code> class, <code>UnpaidIntern</code> class, and any other class that might need <code>Halter</code> behavior. By keeping the <code>Halter</code> code in a separate specialized <code>Halter</code> class, you have the chance to reuse the <code>Halter</code> class in multiple applications.</p>
<p class="indent">Users of the <code>Horse</code> class (that is, code that calls methods on a <code>Horse</code> instance) think that the <code>Horse</code> class has <code>Halter</code> behavior. The <code>Horse</code> class might have a <code>tie(LeadRope rope)</code> method, for example. Users of the <code>Horse</code> class should never have to know that when they invoke the <code>tie()</code> method, the <code>Horse</code> object turns around and delegates the call to its <code>Halter</code> class by invoking <code>myHalter.tie(rope)</code>. The scenario just described might look like this:</p>
<p class="pre"><img src="images/un081-01.jpg" alt="Images" /></p>
<div class="sidebox">
<p class="head"><span id="page_82" epub:type="pagebreak"></span><span class="white">FROM THE CLASSROOM</span></p>
</div>
<div class="sidebox1">
<h4 class="h4">Object-Oriented Design</h4>
<p class="noindent">IS-A and HAS-A relationships and encapsulation are just the tip of the iceberg when it comes to OO design. Many books and graduate theses have been dedicated to this topic. The reason for the emphasis on proper design is simple: money. The cost to deliver a software application has been estimated to be as much as ten times more expensive for poorly designed programs.</p>
<p class="indent">Even the best OO designers (often called “architects”) make mistakes. It is difficult to visualize the relationships between hundreds, or even thousands, of classes. When mistakes are discovered during the implementation (code writing) phase of a project, the amount of code that must be rewritten can sometimes mean programming teams have to start over from scratch.</p>
<p class="indent">The software industry has evolved to aid the designer. Visual object modeling languages, such as the Unified Modeling Language (UML), allow designers to design and easily modify classes without having to write code first because OO components are represented graphically. This allows designers to create a map of the class relationships and helps them recognize errors before coding begins. Another innovation in OO design is design patterns. Designers noticed that many OO designs were applied consistently from project to project and that it was useful to apply the same designs because it reduced the potential to introduce new design errors. OO designers then started to share these designs with each other. Now there are many catalogs of these design patterns both on the Internet and in book form.</p>
<p class="indent">Although passing the Java certification exam does not require you to understand OO design this thoroughly, hopefully this background information will help you better appreciate why the test writers chose to (tacitly) include encapsulation and IS-A and HAS-A relationships on the exam.</p>
<p class="right">—<em>Jonathan Meeks,<br/>Sun Certified Java Programmer</em></p>
</div>
<p class="indent">In OO, we don’t want callers to worry about which class or object is actually doing the real work. To make that happen, the <code>Horse</code> class hides implementation details from <code>Horse</code> users. <code>Horse</code> users ask the <code>Horse</code> object to do things (in this case, tie itself up), and the <code>Horse</code> will either do it or, as in this example, ask something else (like perhaps an inherited <code>Animal</code> class method) to do it. To the caller, though, it always appears that the <code>Horse</code> object takes care of itself. Users of a <code>Horse</code> should not even need to know that there is such a thing as a <code>Halter</code> class.</p>
<p class="title-o"><span id="page_83" epub:type="pagebreak"></span><span class="white"><strong>CERTIFICATION OBJECTIVE</strong></span></p>
<h3 class="h3" id="ch2lev1sec3"><strong>Polymorphism (OCP Objective 1.3)</strong></h3>
<p class="noindentb"><em>1.3   Implement polymorphism.</em></p>
<p class="indent">Remember, any Java object that can pass more than one IS-A test can be considered polymorphic. Other than objects of type <code>Object</code>, <em>all</em> Java objects are polymorphic in that they pass the IS-A test for their own type and for class <code>Object</code>.</p>
<p class="indent">Remember, too, that the only way to access an object is through a reference variable. There are a few key things you should know about references:</p>
<p class="bullt"><img class="inline" src="images/box.jpg" alt="Images" />   A reference variable can be of only one type, and once declared, that type can never be changed (although the object it references can change).</p>
<p class="bull"><img class="inline" src="images/box.jpg" alt="Images" />   A reference is a variable, so it can be reassigned to other objects (unless the reference is declared <code>final</code>).</p>
<p class="bull"><img class="inline" src="images/box.jpg" alt="Images" />   A reference variable’s type determines the methods that can be invoked on the object the variable is referencing.</p>
<p class="bull"><img class="inline" src="images/box.jpg" alt="Images" />   A reference variable can refer to any object of the same type as the declared reference, or—this is the big one—<strong>it can refer to any</strong> <em>subtype</em><strong> of the declared type!</strong></p>
<p class="bullb"><img class="inline" src="images/box.jpg" alt="Images" />   A reference variable can be declared as a class type or an interface type. If the variable is declared as an interface type, it can reference any object of any class that <em>implements</em> the interface.</p>
<p class="indent">Earlier we created a <code>GameShape</code> class that was extended by two other classes, <code>PlayerPiece</code> and <code>TilePiece</code>. Now imagine you want to animate some of the shapes on the gameboard. But not <em>all</em> shapes are able to be animated, so what do you do with class inheritance?</p>
<p class="indent">Could we create a class with an <code>animate()</code> method and have only <em>some</em> of the <code>GameShape</code> subclasses inherit from that class? If we can, then we could have <code>PlayerPiece</code>, for example, extend <em>both</em> the <code>GameShape</code> class and <code>Animatable</code> class, whereas the <code>TilePiece</code> would extend only <code>GameShape</code>. But no, this won’t <span id="page_84" epub:type="pagebreak"></span>work! Java supports only single class inheritance! That means a class can have only one immediate superclass. In other words, if <code>PlayerPiece</code> is a class, there is no way to say something like this:</p>
<p class="pre"><img src="images/un084-01.jpg" alt="Images" /></p>
<p class="indent">A <em>class</em> cannot <em>extend</em> more than one class: that means one parent per class. A class <em>can</em> have multiple ancestors, however, because class B could extend class A, and class C could extend class B, and so on. So any given class might have multiple classes up its inheritance tree, but that’s not the same as saying a class directly extends two classes.</p>
<p class="text-icon"><img src="images/onjob.jpg" alt="Images" /></p>
<p class="noindent"><strong>Some languages (such as C++) allow a class to extend more than one other class. This capability is known as “multiple inheritance.” The reason that Java’s creators chose not to allow multiple class inheritance is that it can become quite messy. In a nutshell, the problem is that if a class extended two other classes, and both superclasses had, say, a <strong><em>doStuff()</em></strong> method, which version of <strong><em>doStuff()</em></strong> would the subclass inherit? This issue can lead to a scenario sometimes called the “Deadly Diamond of Death,” because of the shape of the class diagram that can be created in a multiple inheritance design. The diamond is formed when classes B and C both extend A and both B and C inherit a method from A. If class D extends both B and C, and both B and C have overridden the method in A, class D has, in theory, inherited two different implementations of the same method. Drawn as a class diagram, the shape of the four classes looks like a diamond.</strong></p>
<div class="side">
<p class="exam"><img src="images/exam.jpg" alt="Images" /></p>
</div>
<div class="side1">
<p class="indent"><strong><em>To reiterate, as of Java 8, interfaces can have concrete methods (marked <code>default</code> or <code>static</code> methods). This allows for a form of multiple inheritance, which we’ll discuss later in the chapter.</em></strong></p>
</div>
<p class="indent">So if that doesn’t work, what else could you do? You could simply put the <code>animate()</code> code in <code>GameShape</code>, and then disable the method in classes that can’t be animated. But that’s a bad design choice for many reasons—it’s more error-prone; it makes the <code>GameShape</code> class less cohesive; and it means the <code>GameShape</code> API “advertises” that all shapes can be animated when, in fact, that’s not true since only some of the <code>GameShape</code> subclasses will be able to run the <code>animate()</code> method successfully.</p>
<p class="indent"><span id="page_85" epub:type="pagebreak"></span>So what <em>else</em> could you do? You already know the answer—create an <code>Animatable</code> <em>interface</em> and have only the <code>GameShape</code> subclasses that can be animated implement that interface. Here’s the interface:</p>
<p class="pre"><img src="images/un085-01.jpg" alt="Images" /></p>
<p class="indent">And here’s the modified <code>PlayerPiece</code> class that implements the interface:</p>
<p class="pre"><img src="images/un085-02.jpg" alt="Images" /></p>
<p class="indent">So now we have a <code>PlayerPiece</code> that passes the IS-A test for both the <code>GameShape</code> class and the <code>Animatable</code> interface. That means a <code>PlayerPiece</code> can be treated polymorphically as one of four things at any given time, depending on the declared type of the reference variable:</p>
<p class="bullt"><img class="inline" src="images/box.jpg" alt="Images" />   An <code>Object</code> (since any object inherits from <code>Object</code>)</p>
<p class="bull"><img class="inline" src="images/box.jpg" alt="Images" />   A <code>GameShape</code> (since <code>PlayerPiece</code> extends <code>GameShape</code>)</p>
<p class="bull"><img class="inline" src="images/box.jpg" alt="Images" />   A <code>PlayerPiece </code>(since that’s what it really is)</p>
<p class="bullb"><img class="inline" src="images/box.jpg" alt="Images" />   An <code>Animatable</code> (since <code>PlayerPiece</code> implements <code>Animatable</code>)</p>
<p class="indent">The following are all legal declarations. Look closely:</p>
<p class="pre"><img src="images/un085-03.jpg" alt="Images" /></p>
<p class="indent">There’s only one object here—an instance of type <code>PlayerPiece</code>—but there are four different types of reference variables, all referring to that one object on the heap. Pop quiz: Which of the preceding reference variables can invoke the <code>displayShape()</code> method? Hint: Only two of the four declarations can be used to invoke the <code>displayShape()</code> method.</p>
<p class="indent">Remember that method invocations allowed by the compiler are based solely on the declared type of the reference, regardless of the object type. So looking <span id="page_86" epub:type="pagebreak"></span>at the four reference types again—<code>Object</code>, <code>GameShape</code>, <code>PlayerPiece</code>, and <code>Animatable</code>—which of these four types know about the <code>displayShape()</code> method?</p>
<p class="indent">You guessed it—both the <code>GameShape</code> class and the <code>PlayerPiece</code> class are known (by the compiler) to have a <code>displayShape()</code> method, so either of those reference types can be used to invoke <code>displayShape()</code>. Remember that to the compiler, a <code>PlayerPiece</code> IS-A <code>GameShape</code>, so the compiler says, “I see that the declared type is <code>PlayerPiece</code>, and since <code>PlayerPiece</code> extends <code>GameShape</code>, that means <code>PlayerPiece</code> inherited the <code>displayShape()</code> method. Therefore, <code>PlayerPiece</code> can be used to invoke the <code>displayShape()</code> method.“</p>
<p class="indent">Which methods can be invoked when the <code>PlayerPiece</code> object is being referred to using a reference declared as type <code>Animatable</code>? Only the <code>animate()</code> method. Of course, the cool thing here is that any class from any inheritance tree can also implement <code>Animatable</code>, so that means if you have a method with an argument declared as type <code>Animatable</code>, you can pass in <code>PlayerPiece</code> objects, <code>SpinningLogo</code> objects, and anything else that’s an instance of a class that implements <code>Animatable</code>. And you can use that parameter (of type <code>Animatable</code>) to invoke the <code>animate()</code> method but not the <code>displayShape()</code> method (which it might not even have), or anything other than what is known to the compiler based on the reference type. The compiler always knows, though, that you can invoke the methods of class <code>Object</code> on any object, so those are safe to call regardless of the reference—class or interface—used to refer to the object.</p>
<p class="indent">We’ve left out one big part of all this, which is that even though the compiler only knows about the declared reference type, the Java Virtual Machine (JVM) at runtime knows what the object really is. And that means even if the <code>PlayerPiece</code> object’s <code>displayShape()</code> method is called using a <code>GameShape</code> reference variable, if the <code>PlayerPiece</code> overrides the <code>displayShape()</code> method, the JVM will invoke the <code>PlayerPiece</code> version! The JVM looks at the real object at the other end of the reference, “sees” that it has overridden the method of the declared reference variable type, and invokes the method of the object’s actual class. But there is one other thing to keep in mind:</p>
<p class="ind-bq"><strong>Polymorphic method invocations apply only to <em>instance methods.</em></strong><strong> You can always refer to an object with a more general reference variable type (a superclass or interface), but at runtime, the ONLY things that are dynamically selected based on the actual <em>object</em></strong><strong> (rather than the <em>reference</em></strong><strong> type) are instance methods. Not <em>static</em></strong><strong> methods. Not <em>variables</em></strong><strong>. Only overridden instance methods are dynamically invoked based on the real object’s type.</strong></p>
<p class="noindent"><span id="page_87" epub:type="pagebreak"></span>Because this definition depends on a clear understanding of overriding and the distinction between static methods and instance methods, we’ll cover those later in the chapter.</p>
<p class="title-o"><span class="white"><strong>CERTIFICATION OBJECTIVE</strong></span></p>
<h3 class="h3" id="ch2lev1sec4"><strong>Overriding/Overloading (OCP Objectives 1.2, 1.3, and 2.5)</strong></h3>
<p class="noindent"><em>1.2   Implement inheritance including visibility modifiers and composition.</em></p>
<p class="noindent"><em>1.3   Implement polymorphism.</em></p>
<p class="noindentb"><em>2.5   Develop code that declares, implements and/or extends interfaces and use the @Override annotation.</em></p>
<p class="indent">The exam will use overridden and overloaded methods on many, many questions. These two concepts are often confused (perhaps because they have similar names?), but each has its own unique and complex set of rules. It’s important to get really clear about which “over” uses which rules!</p>
<h4 class="h4" id="ch2lev2sec3"><strong>Overridden Methods</strong></h4>
<p class="noindent">Any time a type inherits a method from a supertype, you have the opportunity to override the method (unless, as you learned earlier, the method is marked <code>final</code>). The key benefit of overriding is the ability to define behavior that’s specific to a particular subtype. The following example demonstrates a <code>Horse</code> subclass of <code>Animal</code> overriding the <code>Animal</code> version of the <code>eat()</code> method:</p>
<p class="pre"><img src="images/un087-01.jpg" alt="Images" /></p>
<p class="indent"><span id="page_88" epub:type="pagebreak"></span>For abstract methods, you inherit from a supertype; you have no choice: You <em>must</em> implement the method in the subtype <strong><em>unless the subtype is also abstract.</em></strong> Abstract methods must be <em>implemented</em> by the first concrete subclass, but this is a lot like saying the concrete subclass <em>overrides</em> the abstract methods of the supertype(s). So you could think of abstract methods as methods you’re forced to override—eventually.</p>
<p class="indent">The <code>Animal</code> class creator might have decided that for the purposes of polymorphism, all <code>Animal</code> subtypes should have an <code>eat()</code> method defined in a unique way. Polymorphically, when an <code>Animal</code> reference refers not to an <code>Animal</code> instance but to an <code>Animal</code> subclass instance, the caller should be able to invoke <code>eat()</code> on the <code>Animal</code> reference; however, the actual runtime object (say, a <code>Horse</code> instance) will run its own specific <code>eat()</code> method. Marking the <code>eat()</code> method abstract is the <code>Animal</code> programmer’s way of saying to all subclass developers, “It doesn’t make any sense for your new subtype to use a generic <code>eat()</code> method, so you have to come up with your <em>own</em> <code>eat()</code> method implementation!” A (nonabstract) example of using polymorphism looks like this:</p>
<p class="pre"><img src="images/un088-01.jpg" alt="Images" /></p>
<p class="indent">In the preceding code, the test class uses an <code>Animal</code> reference to invoke a method on a <code>Horse</code> object. Remember, the compiler will allow only methods in class <code>Animal</code> to be invoked when using a reference to an <code>Animal</code>. The following would not be legal given the preceding code:</p>
<p class="pre"><img src="images/un088-02.jpg" alt="Images" /></p>
<p class="indent"><span id="page_89" epub:type="pagebreak"></span>To reiterate, the compiler looks only at the reference type, not the instance type. Polymorphism lets you use a more abstract supertype (including an interface) reference to one of its subtypes (including interface implementers).</p>
<p class="indent">The overriding method cannot have a more restrictive access modifier than the method being overridden (for example, you can’t override a method marked <code>public</code> and make it <code>protected</code>). Think about it: If the <code>Animal</code> class advertises a <code>public eat()</code> method and someone has an <code>Animal</code> reference (in other words, a reference declared as type <code>Animal</code>), that someone will assume it’s safe to call <code>eat()</code> on the <code>Animal</code> reference regardless of the actual instance that the <code>Animal</code> reference is referring to. If a subtype were allowed to sneak in and change the access modifier on the overriding method, then suddenly at runtime—when the JVM invokes the true object’s (<code>Horse</code>) version of the method rather than the reference type’s (<code>Animal</code>) version—the program would die a horrible death. (Not to mention the emotional distress for the one who was betrayed by the rogue subtype.)</p>
<p class="indent">Let’s modify the polymorphic example you saw earlier in this section:</p>
<p class="pre"><img src="images/un089-01.jpg" alt="Images" /></p>
<p class="indent">If this code compiled (which it doesn’t), the following would fail at runtime:</p>
<p class="pre"><img src="images/un089-02.jpg" alt="Images" /></p>
<p class="indent">The variable <code>b</code> is of type <code>Animal</code>, which has a <code>public eat()</code> method. But remember that at runtime, Java uses virtual method invocation to dynamically select the actual version of the method that will run, based on the actual instance. An <code>Animal</code> reference can always refer to a <code>Horse</code> instance because <code>Horse</code> <span id="page_90" epub:type="pagebreak"></span>IS-A(n) <code>Animal</code>. What makes that supertype reference to a subtype instance possible is that the subtype is guaranteed to be able to do everything the supertype can do. Whether the <code>Horse</code> instance overrides the inherited methods of <code>Animal</code> or simply inherits them, anyone with an <code>Animal</code> reference to a <code>Horse</code> instance is free to call all accessible <code>Animal</code> methods. For that reason, an overriding method must fulfill the contract of the superclass.</p>
<p class="indent">Note: In <a href="ch3.xhtml#ch3">Chapter 3</a> we will explore exception handling in detail. Once you’ve studied <a href="ch3.xhtml#ch3">Chapter 3</a>, you’ll appreciate this single handy list of overriding rules. The rules for overriding a method are as follows:</p>
<p class="bullt"><img class="inline" src="images/box.jpg" alt="Images" />   The argument list must exactly match that of the overridden method. If they don’t match, you can end up with an overloaded method you didn’t intend.</p>
<p class="bull"><img class="inline" src="images/box.jpg" alt="Images" />   The return type must be the same as, or a subtype of, the return type declared in the original overridden method in the superclass. (More on this in a few pages when we discuss covariant returns.)</p>
<p class="bull"><img class="inline" src="images/box.jpg" alt="Images" />   The access level can’t be more restrictive than that of the overridden method.</p>
<p class="bull"><img class="inline" src="images/box.jpg" alt="Images" />   The access level CAN be less restrictive than that of the overridden method.</p>
<p class="bull"><img class="inline" src="images/box.jpg" alt="Images" />   Instance methods can be overridden only if they are inherited by the subtype. A subtype within the same package as the instance’s supertype can override any supertype method that is not marked <code>private</code> or <code>final</code>. A subtype in a different package can override only those non<code>final</code> methods marked <code>public</code> or <code>protected</code> (since <code>protected</code> methods are inherited by the subtype).</p>
<p class="bull"><img class="inline" src="images/box.jpg" alt="Images" />   The overriding method CAN throw any unchecked (runtime) exception, regardless of whether the overridden method declares the exception.</p>
<p class="bull"><img class="inline" src="images/box.jpg" alt="Images" />   The overriding method must NOT throw checked exceptions that are new or broader than those declared by the overridden method. For example, a method that declares a <code>FileNotFoundException</code> cannot be overridden by a method that declares a <code>SQLException</code>, <code>Exception</code>, or any other non-runtime exception unless it’s a subclass of <code>FileNotFoundException</code>.</p>
<p class="bull"><img class="inline" src="images/box.jpg" alt="Images" />   The overriding method can throw narrower or fewer exceptions. Just because an overridden method “takes risks” doesn’t mean that the overriding subtype’s exception takes the same risks. Bottom line: an overriding method doesn’t have to declare any exceptions that it will never throw, regardless of what the overridden method declares.</p>
<p class="bull"><span id="page_91" epub:type="pagebreak"></span><img class="inline" src="images/box.jpg" alt="Images" />   You cannot override a method marked <code>final</code>.</p>
<p class="bull"><img class="inline" src="images/box.jpg" alt="Images" />   You cannot override a method marked <code>static</code>. We’ll look at an example in a few pages when we discuss <code>static</code> methods in more detail.</p>
<p class="bull"><img class="inline" src="images/box.jpg" alt="Images" />   If a method can’t be inherited, you cannot override it. Remember that overriding implies that you’re reimplementing a method you inherited! For example, the following code is not legal, and even if you added an <code>eat()</code> method to <code>Horse</code>, it wouldn’t be an override of <code>Animal</code>’s <code>eat()</code> method.</p>
<p class="pre"><img src="images/un091-01.jpg" alt="Images" /></p>
<h5 class="h5">Invoking a Supertype Version of an Overridden Method</h5>
<p class="noindent">Often, you’ll want to take advantage of some of the code in the supertype version of a method, yet still override it to provide some additional specific behavior. It’s like saying, “Run the supertype version of the method, and then come back down here and finish with my subtype additional method code.” (Note that there’s no requirement that the supertype version run before the subtype code.) It’s easy to do in code using the keyword <code>super</code> as follows:</p>
<p class="pre"><img src="images/un091-02.jpg" alt="Images" /></p>
<p class="indent"><span id="page_92" epub:type="pagebreak"></span>In a similar way, you can access an interface’s overridden method with the syntax:</p>
<p class="pre"><code>InterfaceX.super.doStuff();</code></p>
<p class="noindent">Note: Using <code>super</code> to invoke an overridden method applies only to instance methods. (Remember that <code>static</code> methods can’t be overridden.) And you can use <code>super</code> only to access a method in a type’s supertype, not the supertype of the supertype—that is, you <strong>cannot</strong> say <code>super.super.doStuff()</code> and you <strong>cannot</strong> say <code>InterfaceX</code>.<code>super.super.doStuff()</code>.</p>
<div class="side">
<p class="exam"><img src="images/exam.jpg" alt="Images" /></p>
</div>
<div class="side1">
<p class="indent"><strong><em>If a method is overridden but you use a polymorphic (supertype) reference to refer to the subtype object with the overriding method, the compiler assumes you’re calling the supertype version of the method. If the supertype version declares a checked exception, but the overriding subtype method does not, the compiler still thinks you are calling a method that declares an exception. Let’s look at an example:</em></strong></p>
<p class="pre"><img src="images/un092-03.jpg" alt="Images" /></p>
<p class="noindent"><strong><em>This code will not compile because of the exception declared on the <code>Animal eat</code>() method. This happens even though, at runtime, the <code>eat</code>() method used would be the <code>Dog</code> version, which does not declare the exception.</em></strong></p>
</div>
<h5 class="h5">Examples of Illegal Method Overrides</h5>
<p class="noindent">Let’s take a look at overriding the <code>eat()</code> method of <code>Animal</code>:</p>
<p class="pre"><img src="images/un092-04.jpg" alt="Images" /></p>
<p class="indent"><span id="page_93" epub:type="pagebreak"></span><a href="ch2.xhtml#ch2tab2">Table 2-2</a> lists examples of illegal overrides of the <code>Animal eat()</code> method, given the preceding version of the <code>Animal</code> class.</p>
<p class="tabcap" id="ch2tab2"><span class="table"><strong>TABLE 2-2</strong></span> Examples of Illegal Overrides</p>
<p class="imaget"><img src="images/tab02-02.jpg" alt="Images" /></p>
<h5 class="h5">Using @Override</h5>
<p class="noindent">Java 5 introduced the <code>@Override</code> annotation, which you can use to help catch errors with overriding or implementing at compile time. If you intend to override a method in a superclass or implement a method in an interface, you can annotate that method with <code>@Override</code>, like this:</p>
<p class="pre"><img src="images/un093-01.jpg" alt="Images" /></p>
<p class="indent">Now, if you make a mistake in how you override the <code>eat()</code> method, the compiler will warn you. For instance, let’s say you accidentally add a parameter to the <code>eat()</code> method:</p>
<p class="pre"><img src="images/un093-02.jpg" alt="Images" /></p>
<p class="noindent">Without the <code>@Override</code>, the Java compiler is fine with this code, but what you’ve done is <em>overload</em> the <code>eat()</code> <span id="page_94" epub:type="pagebreak"></span>method, not <em>override</em> it. If you then call the <code>eat()</code> method on a <code>Horse</code>, without passing in an <code>int</code>, you’ll get the <code>Animal</code>’s <code>eat()</code> method, not the <code>Horse</code>’s <code>eat()</code> method, as you intended.</p>
<p class="indent">Add the <code>@Override</code>, however, and, you’ll see a compiler error something like:</p>
<p class="pre"><img src="images/un094-01.jpg" alt="Images" /></p>
<p class="noindent">This also works if you, let’s say, misspell the name of the method you want to override:</p>
<p class="pre"><img src="images/un094-02.jpg" alt="Images" /></p>
<p class="noindent">Again, you’ll see a compiler error indicating that something is wrong.</p>
<p class="indent"><code>@Override</code> is not required when overriding or implementing, but it can help prevent mistakes, and it also makes it easier for other programmers reading your code to know what you intended.</p>
<h4 class="h4" id="ch2lev2sec4"><strong>Overloaded Methods</strong></h4>
<p class="noindent">Over<em>loaded</em> methods let you reuse the same method name in a class, but with different arguments (and, optionally, a different return type). Overloading a method often means you’re being a little nicer to those who call your methods because your code takes on the burden of coping with different argument types rather than forcing the caller to do conversions prior to invoking your method. The rules aren’t too complex:</p>
<p class="bullt"><img class="inline" src="images/box.jpg" alt="Images" />   Overloaded methods MUST change the argument list.</p>
<p class="bull"><img class="inline" src="images/box.jpg" alt="Images" />   Overloaded methods CAN change the return type.</p>
<p class="bull"><img class="inline" src="images/box.jpg" alt="Images" />   Overloaded methods CAN change the access modifier.</p>
<p class="bull"><img class="inline" src="images/box.jpg" alt="Images" />   Overloaded methods CAN declare new or broader checked exceptions.</p>
<p class="bullb"><span id="page_95" epub:type="pagebreak"></span><img class="inline" src="images/box.jpg" alt="Images" />   A method can be overloaded in the <em>same</em> type or in a <em>subtype</em>. In other words, if class A defines a <code>doStuff(int i)</code> method, then subclass B could define a <code>doStuff(String s)</code> method without overriding the superclass version that takes an <code>int</code>. So two methods with the same name but in different types can still be considered overloaded if the subtype inherits one version of the method and then declares another overloaded version in its type definition.</p>
<div class="side">
<p class="exam"><img src="images/exam.jpg" alt="Images" /></p>
</div>
<div class="side1">
<p class="indent"><strong><em>Less experienced Java developers are often confused about the subtle differences between overloaded and overridden methods. Be careful to recognize when a method is overloaded rather than overridden. You might see a method that appears to be violating a rule for overriding, but that is actually a legal overload, as follows:</em></strong></p>
<p class="pre"><img src="images/un095-01.jpg" alt="Images" /></p>
<p class="indent"><strong><em>It’s tempting to see the <code>IOException</code> as the problem because the overridden <code>doStuff</code>() method doesn’t declare an exception and <code>IOException</code> is checked by the compiler. But the <code>doStuff</code>() method is not overridden! Subclass <code>Bar</code> overloads the <code>doStuff</code>() method by varying the argument list, so all the code, including the <code>IOException</code>, is fine.</em></strong></p>
</div>
<h5 class="h5">Legal Overloads</h5>
<p class="noindent">Let’s look at a method we want to overload:</p>
<p class="pre"><code>public void changeSize(int size, String name, float pattern) { }</code></p>
<p class="indent">The following methods are legal overloads of the <code>changeSize()</code> method:</p>
<p class="pre"><img src="images/un095-02.jpg" alt="Images" /></p>
<h5 class="h5"><span id="page_96" epub:type="pagebreak"></span>Invoking Overloaded Methods</h5>
<p class="noindent">When a method is invoked, more than one method of the same name might exist for the object type you’re invoking a method on. For example, the <code>Horse</code> class might have three methods with the same name but with different argument lists, which means the method is overloaded.</p>
<p class="indent">Decide which of the matching methods to invoke based on the arguments. If you invoke the method with a <code>String</code> argument, the overloaded version that takes a <code>String</code> is called. If you invoke a method of the same name but pass it a <code>float</code>, the overloaded version that takes a <code>float</code> will run. If you invoke the method of the same name but pass it a <code>Foo</code> object and there isn’t an overloaded version that takes a <code>Foo</code>, then the compiler will complain that it can’t find a match. The following are examples of invoking overloaded methods:</p>
<p class="pre"><img src="images/un096-01.jpg" alt="Images" /></p>
<p class="noindent">In this <code>TestAdder</code> code, the first call to <code>a.addThem(b,c)</code> passes two <code>int</code>s to the method, so the first version of <code>addThem()</code>—the overloaded version that takes two <code>int</code> arguments—is called. The second call to <code>a.addThem(22.5, 9.3)</code> passes two <code>double</code>s to the method, so the second version of <code>addThem()</code>—the overloaded version that takes two double arguments—is called.</p>
<p class="indent">Invoking overloaded methods that take object references rather than primitives is a little more interesting. Say you have an overloaded method such that one version takes an <code>Animal</code> and one takes a <code>Horse</code> (subclass of <code>Animal</code>). If you pass a <code>Horse</code> object in the method invocation, you’ll invoke the overloaded version that takes a <code>Horse</code>. Or so it looks at first glance:</p>
<p class="pre"><span id="page_97" epub:type="pagebreak"></span><img src="images/un097-01.jpg" alt="Images" /></p>
<p class="indent">The output is what you expect:</p>
<p class="pre"><img src="images/un097-01a.jpg" alt="Images" /></p>
<p class="indent">But what if you use an <code>Animal</code> reference to a <code>Horse</code> object?</p>
<p class="pre"><img src="images/un097-02.jpg" alt="Images" /></p>
<p class="noindent">Which of the overloaded versions is invoked? You might want to answer, “The one that takes a <code>Horse</code> since it’s a <code>Horse</code> object at runtime that’s being passed to the method.” But that’s not how it works. The preceding code would actually print this:</p>
<p class="pre"><code>in the Animal version</code></p>
<p class="noindent">Even though the actual object at runtime is a <code>Horse</code> and not an <code>Animal</code>, the choice of which overloaded method to call (in other words, the signature of the method) is NOT dynamically decided at runtime.</p>
<p class="indent">Just remember—the <em>reference</em> type (not the object type) determines which overloaded method is invoked!</p>
<p class="indent"><strong>To summarize, which over</strong><strong><em>ridden</em></strong><strong> version of the method to call (in other words, from which class in the inheritance tree) is decided at <em>runtime</em></strong><strong> based on <em>object</em></strong><strong> type, but which over</strong><strong><em>loaded</em></strong><strong> version of the method to call is based on the <em>reference</em></strong><strong> type of the argument passed at <em>compile</em></strong><strong> time.</strong></p>
<p class="indent">If you invoke a method passing it an <code>Animal</code> reference to a <code>Horse</code> object, the compiler knows only about the <code>Animal</code>, so it chooses the overloaded version of the method that takes an <code>Animal</code>. It does not matter that, at runtime, a <code>Horse</code> is actually being passed.</p>
<div class="side">
<p class="exam"><span id="page_98" epub:type="pagebreak"></span><img src="images/exam.jpg" alt="Images" /></p>
</div>
<div class="side1">
<p class="indent"><strong><em>Can <code>main</code>() be overloaded?</em></strong></p>
<p class="pre"><img src="images/un098-01.jpg" alt="Images" /></p>
<p class="noindent"><strong><em>Absolutely! But the only <code>main</code>() with JVM superpowers is the one with the signature you’ve seen about 100 times already in this book.</em></strong></p>
</div>
<p class="noindentt"><strong>Polymorphism in Overloaded and Overridden Methods</strong>   How does polymorphism work with overloaded methods? From what we just looked at, it doesn’t appear that polymorphism matters when a method is overloaded. If you pass an <code>Animal</code> reference, the overloaded method that takes an <code>Animal</code> will be invoked, even if the actual object passed is a <code>Horse</code>. Once the <code>Horse</code> masquerading as <code>Animal</code> gets in to the method, however, the <code>Horse</code> object is still a <code>Horse</code> despite being passed into a method expecting an <code>Animal</code>. So it’s true that polymorphism doesn’t determine which overloaded version is called; polymorphism does come into play when the decision is about which overridden version of a method is called. But sometimes a method is both overloaded and overridden. Imagine that the <code>Animal</code> and <code>Horse</code> classes look like this:</p>
<p class="pre"><img src="images/un098-02.jpg" alt="Images" /></p>
<p class="indent"><span id="page_99" epub:type="pagebreak"></span>Notice that the <code>Horse</code> class has both overloaded and overridden the <code>eat()</code> method. <a href="ch2.xhtml#ch2tab3">Table 2-3</a> shows which version of the three <code>eat()</code> methods will run depending on how they are invoked.</p>
<p class="tabcap" id="ch2tab3"><span class="table"><strong>TABLE 2-3</strong></span> Examples of Legal and Illegal Overrides</p>
<p class="imaget"><img src="images/tab02-03.jpg" alt="Images" /></p>
<div class="side">
<p class="exam"><img src="images/exam.jpg" alt="Images" /></p>
</div>
<div class="side1">
<p class="indent"><strong><em>Don’t be fooled by a method that’s overloaded but not overridden by a subclass. It’s perfectly legal to do the following:</em></strong></p>
<p class="pre"><img src="images/un099-01.jpg" alt="Images" /></p>
<p class="noindent"><strong><em>The <code>Bar</code> class has two <code>doStuff</code>() methods: the no-arg version it inherits from <code>Foo</code> (and does not override) and the overloaded <code>doStuff</code>(<code>String s</code>) defined in the <code>Bar</code> class. Code with a reference to a <code>Foo</code> can invoke only the no-arg version, but code with a reference to a <code>Bar</code> can invoke either of the overloaded versions.</em></strong></p>
</div>
<p class="indent"><span id="page_100" epub:type="pagebreak"></span><a href="ch2.xhtml#ch2tab4">Table 2-4</a> summarizes the difference between overloaded and overridden methods.</p>
<p class="tabcap" id="ch2tab4"><span class="table"><strong>TABLE 2-4</strong></span> Differences Between Overloaded and Overridden Methods</p>
<p class="imaget"><img src="images/tab02-04.jpg" alt="Images" /></p>
<p class="indent">We’ll cover constructor overloading later in the chapter, where we’ll also cover the other constructor-related topics that are on the exam. <a href="ch2.xhtml#ch2fig4">Figure 2-4</a> illustrates the way overloaded and overridden methods appear in class relationships.</p>
<p class="figcap" id="ch2fig4"><span class="figure"><strong>FIGURE 2-4</strong></span></p>
<p class="figcap1">Overloaded and overridden methods in class relationships</p>
<p class="imagef"><img src="images/fig02-04.jpg" alt="Images" /></p>
<p class="title-o"><span id="page_101" epub:type="pagebreak"></span><span class="white"><strong>CERTIFICATION OBJECTIVE</strong></span></p>
<h3 class="h3" id="ch2lev1sec5"><strong>Casting (OCP Objectives 1.2 and 1.3)</strong></h3>
<p class="noindent"><em>1.2   Implement inheritance including visibility modifiers and composition.</em></p>
<p class="noindentb"><em>1.3   Implement polymorphism.</em></p>
<p class="indent">You’ve seen how it’s both possible and common to use general reference variable types to refer to more specific object types. It’s at the heart of polymorphism. For example, this line of code should be second nature by now:</p>
<p class="pre"><code>Animal animal = new Dog();</code></p>
<p class="indent">But what happens when you want to use that <code>animal</code> reference variable to invoke a method that only class <code>Dog</code> has? You know it’s referring to a <code>Dog</code>, and you want to do a <code>Dog</code>-specific thing? In the following code, we’ve got an array of <code>Animal</code>s, and whenever we find a <code>Dog</code> in the array, we want to do a special <code>Dog</code> thing. Let’s agree for now that all this code is okay, except we’re not sure about the line of code that invokes the <code>playDead</code> method:</p>
<p class="pre"><img src="images/un101-02.jpg" alt="Images" /></p>
<p class="indent">When we try to compile this code, the compiler says something like this:</p>
<p class="pre"><code>cannot find symbol</code></p>
<p class="noindent"><span id="page_102" epub:type="pagebreak"></span>The compiler is saying, “Hey, class <code>Animal</code> doesn’t have a <code>playDead()</code> method.” Let’s modify the <code>if</code> code block:</p>
<p class="pre"><img src="images/un102-01.jpg" alt="Images" /></p>
<p class="indent">The new and improved code block contains a cast, which in this case is sometimes called a <em>downcast</em>, because we’re casting down the inheritance tree to a more specific class. Now the compiler is happy. Before we try to invoke <code>playDead</code>, we cast the <code>animal</code> variable to type <code>Dog</code>. What we’re saying to the compiler is, “We know it’s really referring to a <code>Dog</code> object, so it’s okay to make a new <code>Dog</code> reference variable to refer to that object.” In this case we’re safe, because before we ever try the cast, we do an <code>instanceof</code> test to make sure.</p>
<p class="indent">It’s important to know that the compiler is forced to trust us when we do a downcast, even when we screw up:</p>
<p class="pre"><img src="images/un102-02.jpg" alt="Images" /></p>
<p class="noindent">It can be maddening! This code compiles! But when we try to run it, we’ll get an exception, something like this:</p>
<p class="pre"><code>java.lang.ClassCastException</code></p>
<p class="indent">Why can’t we trust the compiler to help us out here? Can’t it see that <code>animal</code> is of type <code>Animal</code>? All the compiler can do is verify that the two types are in the same inheritance tree, so depending on whatever code might have come before the downcast, it’s possible that <code>animal</code> is of type <code>Dog</code>. The compiler must allow things that might possibly work at runtime. However, if the compiler knows with certainty that the cast could not possibly work, compilation will fail. The following replacement code block will NOT compile:</p>
<p class="pre"><img src="images/un102-04.jpg" alt="Images" /></p>
<p class="noindent"><span id="page_103" epub:type="pagebreak"></span>In this case, you’ll get an error something like this:</p>
<p class="pre"><code>inconvertible types:Animal cannot be converted to a String</code></p>
<p class="indent">Unlike downcasting, <em>upcasting</em> (casting <em>up</em> the inheritance tree to a more general type) works implicitly (that is, you don’t have to type in the cast) because when you upcast you’re implicitly restricting the number of methods you can invoke, as opposed to <em>down</em>casting, which implies that later on you might want to invoke a more <em>specific</em> method. Here’s an example:</p>
<p class="pre"><img src="images/un103-02.jpg" alt="Images" /></p>
<p class="indent">Both of the previous upcasts will compile and run without exception because a <code>Dog</code> IS-A(n) <code>Animal</code>, which means that anything an <code>Animal</code> can do, a <code>Dog</code> can do. A <code>Dog</code> can do more, of course, but the point is that anyone with an <code>Animal</code> reference can safely call <code>Animal</code> methods on a <code>Dog</code> instance. The <code>Animal</code> methods may have been overridden in the <code>Dog</code> class, but all we care about now is that a <code>Dog</code> can always do at least everything an <code>Animal</code> can do. The compiler and JVM know it, too, so the implicit upcast is always legal for assigning an object of a subtype to a reference of one of its supertype classes (or interfaces). If <code>Dog</code> implements <code>Pet</code> and <code>Pet</code> defines <code>beFriendly()</code>, then a <code>Dog</code> can be implicitly cast to a <code>Pet</code>, but the only <code>Dog</code> method you can invoke then is <code>beFriendly()</code>, which <code>Dog</code> was forced to implement because <code>Dog</code> implements the <code>Pet</code> interface.</p>
<p class="indent">One more thing…if <code>Dog</code> implements <code>Pet</code>, then, if <code>Beagle</code> extends <code>Dog</code> but <code>Beagle</code> does not <em>declare</em> that it implements <code>Pet</code>, <code>Beagle</code> is still a <code>Pet</code>! <code>Beagle</code> is a <code>Pet</code> simply because it extends <code>Dog</code>, and <code>Dog</code>’s already taken care of the <code>Pet</code> parts for itself and for all its children. The <code>Beagle</code> class can always override any method it inherits from <code>Dog</code>, including methods that <code>Dog</code> implemented to fulfill its interface contract.</p>
<p class="indent">And just one more thing…if <code>Beagle</code> does declare that it implements <code>Pet</code>, just so that others looking at the <code>Beagle</code> class API can easily see that <code>Beagle</code> IS-A <span id="page_104" epub:type="pagebreak"></span><code>Pet</code> without having to look at <code>Beagle</code>’s superclasses, <code>Beagle</code> still doesn’t need to implement the <code>beFriendly()</code> method if the <code>Dog</code> class (<code>Beagle</code>’s superclass) has already taken care of that. In other words, if <code>Beagle</code> IS-A <code>Dog</code> and <code>Dog</code> IS-A <code>Pet</code>, then <code>Beagle</code> IS-A <code>Pet</code> and has already met its <code>Pet</code> obligations for implementing the <code>beFriendly()</code> method since it inherits the <code>beFriendly()</code> method. The compiler is smart enough to say, “I know <code>Beagle</code> already IS a <code>Dog</code>, but it’s okay to make it more obvious by adding a cast.“</p>
<p class="indent">So don’t be fooled by code that shows a concrete class that declares it implements an interface but doesn’t implement the <em>methods</em> of the interface. Before you can tell whether the code is legal, you must know what the supertypes of this implementing class have declared. If any supertype in its inheritance tree has already provided concrete (that is, nonabstract) method implementations, then regardless of whether the supertype declares that it implements the interface, the subclass is under no obligation to reimplement (override) those methods.</p>
<div class="side">
<p class="exam"><img src="images/exam.jpg" alt="Images" /></p>
</div>
<div class="side1">
<p class="indent"><strong><em>The exam creators will tell you that they’re forced to jam tons of code into little spaces “because of the exam engine.” Although that’s partially true, they also like to obfuscate. The following code</em></strong></p>
<p class="pre"><img src="images/un104-01.jpg" alt="Images" /></p>
<p class="noindent"><strong><em>can be replaced with this easy-to-read bit of fun:</em></strong></p>
<p class="pre"><img src="images/un104-02.jpg" alt="Images" /></p>
<p class="noindent"><strong><em>In this case the compiler needs all those parentheses; otherwise, it thinks it’s been handed an incomplete statement.</em></strong></p>
</div>
<p class="title-o"><span id="page_105" epub:type="pagebreak"></span><span class="white"><strong>CERTIFICATION OBJECTIVE</strong></span></p>
<h3 class="h3" id="ch2lev1sec6"><strong>Implementing an Interface (OCP Objective 2.5)</strong></h3>
<p class="noindentb"><em>2.5   Develop code that declares, implements and/or extends interfaces and use the @Override annotation (sic*).</em></p>
<p class="indent">* This objective tests for two different concepts: the use of interfaces in general and the use of the <code>@Override</code> annotation. As we mentioned in the introduction, some of the official objectives aren’t very well worded. When in doubt about how broadly the exam covers a topic, we suggest that you assume a broader scope, rather than a narrower scope.</p>
<p class="indent">When you implement an interface, you’re agreeing to adhere to the contract defined in the interface. That means you’re agreeing to provide legal implementations for every abstract method defined in the interface, and that anyone who knows what the interface methods look like (not how they’re implemented, but how they can be called and what they return) can rest assured that they can invoke those methods on an instance of your implementing class.</p>
<p class="indent">For example, if you create a class that implements the <code>Runnable</code> interface (so your code can be executed by a specific thread), you must provide the <code>public void run()</code> method. Otherwise, the poor thread could be told to go execute your <code>Runnable</code> object’s code and—surprise, surprise—the thread then discovers the object has no <code>run()</code> method! (At which point, the thread would blow up and the JVM would crash in a spectacular yet horrible explosion.) Thankfully, Java prevents this meltdown from occurring by running a compiler check on any class that claims to implement an interface. If the class says it’s implementing an interface, it darn well better have an implementation for each abstract method in the interface (with a few exceptions that we’ll look at in a moment).</p>
<p class="indent">Assuming an interface <code>Bounceable</code>, with two methods, <code>bounce()</code> and <code>setBounceFactor()</code>, the following class will compile:</p>
<p class="pre"><img src="images/un105-01.jpg" alt="Images" /></p>
<p class="noindent">Okay, we know what you’re thinking: “This has got to be the worst implementation class in the history of implementation classes.” It compiles, though. And it runs. <span id="page_106" epub:type="pagebreak"></span>The interface contract guarantees that a class will have the method (in other words, others can call the method subject to access control), but it never guaranteed a good implementation—or even any actual implementation code in the body of the method. (Keep in mind, though, that if the interface declares that a method is NOT void, your class’s implementation code has to include a return statement.) The compiler will never say, “Um, excuse me, but did you really mean to put nothing between those curly braces? HELLO. This is a method after all, so shouldn’t it do something?“</p>
<p class="indent">Implementation classes must adhere to the same rules for method implementation as a class extending an <code>abstract</code> class. To be a legal implementation class, a nonabstract implementation class must do the following:</p>
<p class="bullt"><img class="inline" src="images/box.jpg" alt="Images" />   Provide concrete (nonabstract) implementations for all abstract methods from the declared interface.</p>
<p class="bull"><img class="inline" src="images/box.jpg" alt="Images" />   Follow all the rules for legal overrides, such as the following:</p>
<p class="bull1"><img class="inline" src="images/box.jpg" alt="Images" />   Declare no checked exceptions on implementation methods other than those declared by the interface method, or subclasses of those declared by the interface method.</p>
<p class="bull1"><img class="inline" src="images/box.jpg" alt="Images" />   Maintain the signature of the interface method, and maintain the same return type (or a subtype). (But it does not have to declare the exceptions declared in the interface method declaration.)</p>
<div class="side">
<p class="exam"><img src="images/exam.jpg" alt="Images" /></p>
</div>
<div class="side1">
<p class="indent"><strong><em>Implementation classes are NOT required to implement an interface’s static or default methods. We’ll discuss this in more depth later in the chapter.</em></strong></p>
</div>
<p class="indentt">But wait, there’s more! An implementation class can itself be <code>abstract</code>! For example, the following is legal for a class <code>Ball</code> implementing <code>Bounceable</code>:</p>
<p class="pre"><code>abstract class Ball implements Bounceable { }</code></p>
<p class="indent">Notice anything missing? We never provided the implementation methods. And that’s okay. If the implementation class is <code>abstract</code>, it can simply pass the buck to its first concrete subclass. For example, if class <code>BeachBall</code> extends <code>Ball</code> and <code>BeachBall</code> is not <code>abstract</code>, then <code>BeachBall</code> has to provide an implementation for all the abstract methods from <code>Bounceable</code>:</p>
<p class="pre"><img src="images/un106-02.jpg" alt="Images" /></p>
<p class="pre"><span id="page_107" epub:type="pagebreak"></span><img src="images/un107-01.jpg" alt="Images" /></p>
<p class="indent">Look for classes that claim to implement an interface but don’t provide the correct method implementations. Unless the implementing class is abstract, the implementing class must provide implementations for all abstract methods defined in the interface.</p>
<p class="indent">You need to know two more rules, and then we can put this topic to sleep (or put you to sleep; we always get those two confused):</p>
<p class="numlist">1.   A class can implement more than one interface. It’s perfectly legal to say, for example, the following:</p>
<p class="numlist-no"><code>public class Ball implements Bounceable, Serializable, Runnable { ... }</code></p>
<p class="numlist-no">You can extend only one class, but you can implement many interfaces (which, as of Java 8, means a form of multiple inheritance, which we’ll discuss shortly). In other words, subclassing defines who and what you are, whereas implementing defines a role you can play or a hat you can wear, despite how different you might be from some other class implementing the same interface (but from a different inheritance tree). For example, a Person extends HumanBeing (although for some, that’s debatable). But a Person may also implement Programmer, Snowboarder, Employee, Parent, or PersonCrazyEnoughToTakeThisExam.</p>
<p class="numlist">2.   An interface can itself extend another interface. The following code is perfectly legal:</p>
<p class="numlist-no"><code>public interface Bounceable extends Moveable { } // ok!</code></p>
<p class="indent">What does that mean? The first concrete (nonabstract) implementation class of <code>Bounceable</code> must implement all the abstract methods of <code>Bounceable</code>, plus all the abstract methods of <code>Moveable</code>! The subinterface, as we call it, simply adds more requirements to the contract of the superinterface. You’ll see this concept applied in many areas of Java, especially Java EE, where you’ll often have to build your own interface that extends one of the Java EE interfaces.</p>
<p class="indent"><span id="page_108" epub:type="pagebreak"></span>Hold on, though, because here’s where it gets strange. An interface can extend more than one interface! Think about that for a moment. You know that when we’re talking about classes, the following is illegal:</p>
<p class="pre"><code>public class Programmer extends Employee, Geek { } // Illegal!</code></p>
<p class="noindent">As we mentioned earlier, a class is not allowed to extend multiple classes in Java. An interface, however, is free to extend multiple interfaces:</p>
<p class="pre"><img src="images/un108-02.jpg" alt="Images" /></p>
<p class="indent">In the next example, <code>Ball</code> is required to implement <code>Bounceable</code>, plus all abstract methods from the interfaces that <code>Bounceable</code> extends (including any interfaces those interfaces extend, and so on, until you reach the top of the stack—or is it the bottom of the stack?). So <code>Ball</code> would need to look like the following:</p>
<p class="pre"><img src="images/un108-03.jpg" alt="Images" /></p>
<p class="indent">If class <code>Ball</code> fails to implement any of the abstract methods from <code>Bounceable</code>, <code>Moveable</code>, or <code>Spherical</code>, the compiler will jump up and down wildly, red in the face, until it does. Unless, that is, class <code>Ball</code> is marked <code>abstract</code>. In that case, <code>Ball</code> could choose to implement some, all, or none of the abstract methods from any of the interfaces, thus leaving the rest of the implementations to a concrete subclass of <code>Ball</code>, as follows:</p>
<p class="pre"><img src="images/un108-04.jpg" alt="Images" /></p>
<p class="pre"><span id="page_109" epub:type="pagebreak"></span><img src="images/un109-01.jpg" alt="Images" /></p>
<p class="indent"><a href="ch2.xhtml#ch2fig5">Figure 2-5</a> compares concrete and <code>abstract</code> examples of extends and implements, for both classes and interfaces.</p>
<p class="figcap" id="ch2fig5"><span class="figure"><strong>FIGURE 2-5</strong></span></p>
<p class="figcap1">Comparing concrete and <code>abstract</code> examples of extends and implements</p>
<p class="imagef"><img src="images/fig02-05.jpg" alt="Images" /></p>
<div class="side">
<p class="exam"><span id="page_110" epub:type="pagebreak"></span><img src="images/exam.jpg" alt="Images" /></p>
</div>
<div class="side1">
<p class="indent"><strong><em>Look for illegal uses of extends and implements. The following shows examples of legal and illegal class and interface declarations:</em></strong></p>
<p class="pre"><img src="images/un110-01.jpg" alt="Images" /></p>
<p class="indent"><strong><em>Burn these into your memory, and watch for abuses in the questions you get on the exam. Regardless of what the question appears to be testing, the real problem might be the class or interface declaration. Before you get caught up in, say, tracing a complex threading flow, check to see if the code will even compile. (Just that tip alone may be worth your putting us in your will!) (You’ll be impressed by the effort the exam developers put into distracting you from the real problem.) (How did people manage to write anything before parentheses were invented?)</em></strong></p>
</div>
<h4 class="h4" id="ch2lev2sec5"><strong>Java 8—Now with Multiple Inheritance!</strong></h4>
<p class="noindent">It might have already occurred to you that since interfaces can now have concrete methods and classes can implement multiple interfaces, the specter of multiple inheritance and the Deadly Diamond of Death can rear its ugly head! Well, you’re partly correct. A class CAN implement interfaces with duplicate, concrete method signatures! But the good news is that the compiler’s got your back, and if you DO <span id="page_111" epub:type="pagebreak"></span>want to implement both interfaces, you’ll have to provide an overriding method in your class. Let’s look at the following code:</p>
<p class="pre"><img src="images/un111-01.jpg" alt="Images" /></p>
<p class="noindent">As the code stands, it WILL NOT COMPILE because it’s not clear which version of <code>doStuff()</code> should be used. In order to make the code compile, you need to override <code>doStuff()</code> in the class. Uncommenting the class’s <code>doStuff()</code> method would allow the code to compile and, when run, produce the output:</p>
<p class="pre"><code>3</code></p>
<p class="title-o"><span class="white"><strong>CERTIFICATION OBJECTIVE</strong></span></p>
<h3 class="h3" id="ch2lev1sec7"><strong>Legal Return Types (OCP Objectives 1.2 and 1.3)</strong></h3>
<p class="noindent"><em>1.2   Implement inheritance including visibility modifiers and composition.</em></p>
<p class="noindentb"><em>1.3   Implement polymorphism.</em></p>
<p class="indent">This section covers two aspects of return types: what you can declare as a return type and what you can actually return as a value. What you can and cannot declare is pretty straightforward, but it all depends on whether you’re overriding an inherited method or simply declaring a new method (which includes overloaded methods). We’ll take just a quick look at the difference between return type rules for overloaded and overriding methods, because we’ve already covered that in this chapter. We’ll cover a small bit of new ground, though, when we look at 113polymorphic return types and the rules for what is and is not legal to actually return.</p>
<h4 class="h4" id="ch2lev2sec6"><span id="page_112" epub:type="pagebreak"></span><strong>Return Type Declarations</strong></h4>
<p class="noindent">This section looks at what you’re allowed to declare as a return type, which depends primarily on whether you are overriding, overloading, or declaring a new method.</p>
<h5 class="h5">Return Types on Overloaded Methods</h5>
<p class="noindent">Remember that method overloading is not much more than name reuse. The overloaded method is a completely different method from any other method of the same name. So if you inherit a method but overload it in a subtype, you’re not subject to the restrictions of overriding, which means you can declare any return type you like. What you can’t do is change <em>only</em> the return type. To overload a method, remember, you must change the argument list. The following code shows an overloaded method:</p>
<p class="pre"><img src="images/un112-01.jpg" alt="Images" /></p>
<p class="indent">Notice that the <code>Bar</code> version of the method uses a different return type. That’s perfectly fine. As long as you’ve changed the argument list, you’re overloading the method, so the return type doesn’t have to match that of the supertype version. What you’re NOT allowed to do is this:</p>
<p class="pre"><img src="images/un112-02.jpg" alt="Images" /></p>
<h5 class="h5">Overriding and Return Types and Covariant Returns</h5>
<p class="noindent">When a subtype wants to change the method implementation of an inherited method (an override), the subtype must define a method that matches the inherited version exactly. Or, since Java 5, you’re allowed to change the return type in the overriding method as long as the new return type is a <em>subtype</em> of the declared return type of the overridden (superclass) method.</p>
<p class="indent"><span id="page_113" epub:type="pagebreak"></span>Let’s look at a covariant return in action:</p>
<p class="pre"><img src="images/un113-01.jpg" alt="Images" /></p>
<p class="noindent">Since Java 5, this code compiles. If you were to attempt to compile this code with a 1.4 compiler or with the source flag as follows,</p>
<p class="pre"><code>javac -source 1.4 Beta.java</code></p>
<p class="noindent">you would get a compiler error like this:</p>
<p class="pre"><code>attempting to use incompatible return type</code></p>
<p class="indent">Other rules apply to overriding, including those for access modifiers and declared exceptions, but those rules aren’t relevant to the return type discussion.</p>
<div class="side">
<p class="exam"><img src="images/exam.jpg" alt="Images" /></p>
</div>
<div class="side1">
<p class="indent"><strong><em>For the exam, be sure you know that overloaded methods can change the return type, but overriding methods can do so only within the bounds of covariant returns. Just that knowledge alone will help you through a wide range of exam questions.</em></strong></p>
</div>
<h4 class="h4" id="ch2lev2sec7"><strong>Returning a Value</strong></h4>
<p class="noindent">You have to remember only six rules for returning a value:</p>
<p class="numlist">1.   You can return <code>null</code> in a method with an object reference return type.</p>
<p class="numlist-no"><img src="images/un113-04.jpg" alt="Images" /></p>
<p class="numlist">2.   An array is a perfectly legal return type.</p>
<p class="numlist-no"><img src="images/un113-05.jpg" alt="Images" /></p>
<p class="numlist"><span id="page_114" epub:type="pagebreak"></span>3.   In a method with a primitive return type, you can return any value or variable that can be implicitly converted to the declared return type.</p>
<p class="numlist-no"><img src="images/un114-01.jpg" alt="Images" /></p>
<p class="numlist">4.   In a method with a primitive return type, you can return any value or variable that can be explicitly cast to the declared return type.</p>
<p class="numlist-no"><img src="images/un114-02.jpg" alt="Images" /></p>
<p class="numlist">5.   You must <em>not</em> return anything from a method with a void return type.</p>
<p class="numlist-no"><img src="images/un114-03.jpg" alt="Images" /></p>
<p class="numlist-no">(Although you can say <code>return;</code>)</p>
<p class="numlist">6.   In a method with an object reference return type, you can return any object type that can be implicitly cast to the declared return type.</p>
<p class="numlist-no"><img src="images/un114-04.jpg" alt="Images" /></p>
<div class="side">
<p class="exam"><span id="page_115" epub:type="pagebreak"></span><img src="images/exam.jpg" alt="Images" /></p>
</div>
<div class="side1">
<p class="indent"><strong><em>Watch for methods that declare an abstract class or interface return type, and know that any object that passes the IS-A test (in other words, would test true using the <code>instanceof</code> operator) can be returned from that method. For example:</em></strong></p>
<p class="pre"><img src="images/un115-01.jpg" alt="Images" /></p>
<p class="noindent"><strong><em>This code will compile, and the return value is a subtype.</em></strong></p>
</div>
<p class="title-o"><span class="white"><strong>CERTIFICATION OBJECTIVE</strong></span></p>
<h3 class="h3" id="ch2lev1sec8"><strong>Constructors and Instantiation (OCP Objectives 1.2 and 1.3)</strong></h3>
<p class="noindent"><em>1.2   Implement inheritance including visibility modifiers and composition.</em></p>
<p class="noindentb"><em>1.3   Implement polymorphism.</em></p>
<p class="indent">Objects are constructed. You CANNOT make a new object without invoking a constructor. In fact, you can’t make a new object without invoking not just the constructor of the object’s actual class type, but also the constructor of each of its superclasses! Constructors are the code that runs whenever you use the keyword <code>new</code>. (Okay, to be a bit more accurate, there can also be initialization blocks that run when you say <code>new</code>, and we’re going to cover initialization blocks and their static initialization counterparts after we discuss constructors.) We’ve got plenty to talk about here—we’ll look at how constructors are coded, who codes them, and how they work at runtime. So grab your hardhat and a hammer, and let’s do some object building.</p>
<h4 class="h4" id="ch2lev2sec8"><span id="page_116" epub:type="pagebreak"></span><strong>Constructor Basics</strong></h4>
<p class="noindent">Every class, <em>including abstract classes,</em> MUST have a constructor. Burn that into your brain. But just because a class must have a constructor doesn’t mean the programmer has to type it. A constructor looks like this:</p>
<p class="pre"><img src="images/un116-01.jpg" alt="Images" /></p>
<p class="noindent">Notice what’s missing? There’s no return type! Two key points to remember about constructors are that they have no return type and their names must exactly match the class name. Typically, constructors are used to initialize the instance variable state, as follows:</p>
<p class="pre"><img src="images/un116-02.jpg" alt="Images" /></p>
<p class="indent">In the preceding code example, the <code>Foo</code> class does not have a no-arg constructor. That means the following will fail to compile,</p>
<p class="pre"><img src="images/un116-03.jpg" alt="Images" /></p>
<p class="noindent">but the following will compile:</p>
<p class="pre"><img src="images/un116-04.jpg" alt="Images" /></p>
<p class="indent">So it’s very common (and desirable) for a class to have a no-arg constructor, regardless of how many other overloaded constructors are in the class (yes, constructors can be overloaded). You can’t always make that work for your classes; occasionally you have a class where it makes no sense to create an instance without supplying information to the constructor. A <code>java.awt.Color</code> object, 118for example, can’t be created by calling a no-arg constructor. That would be like saying to the JVM, “Make me a new Color object, and I really don’t care what color it is…you pick.” Do you seriously want the JVM making your style decisions?</p>
<h4 class="h4" id="ch2lev2sec9"><span id="page_117" epub:type="pagebreak"></span><strong>Constructor Chaining</strong></h4>
<p class="noindent">We know that constructors are invoked at runtime when you say <code>new</code> on some class type as follows:</p>
<p class="pre"><code>Horse h = new Horse();</code></p>
<p class="noindent">But what <em>really</em> happens when you say <code>new Horse()</code>? (Assume <code>Horse</code> extends <code>Animal</code> and <code>Animal</code> extends <code>Object</code>.)</p>
<p class="numlist">1.   The <code>Horse</code> constructor is invoked. Every constructor invokes the constructor of its superclass with an (implicit) call to <code>super()</code>, unless the constructor invokes an overloaded constructor of the same class (more on that in a minute).</p>
<p class="numlist">2.   The <code>Animal</code> constructor is invoked (<code>Animal</code> is the superclass of <code>Horse</code>).</p>
<p class="numlist">3.   The <code>Object</code> constructor is invoked (<code>Object</code> is the ultimate superclass of all classes, so class <code>Animal</code> extends <code>Object</code> even though you don’t actually type “extends Object” into the <code>Animal</code> class declaration; it’s implicit.) At this point we’re on the top of the stack.</p>
<p class="numlist">4.   If class <code>Object</code> had any instance variables, then they would be given their explicit values. By <em>explicit</em> values, we mean values that are assigned at the time the variables are declared, such as <code>int x = 27</code>, where <code>27</code> is the explicit value (as opposed to the default value) of the instance variable.</p>
<p class="numlist">5.   The <code>Object</code> constructor completes.</p>
<p class="numlist">6.   The <code>Animal</code> instance variables are given their explicit values (if any).</p>
<p class="numlist">7.   The <code>Animal</code> constructor completes.</p>
<p class="numlist">8.   The <code>Horse</code> instance variables are given their explicit values (if any).</p>
<p class="numlist">9.   The <code>Horse</code> constructor completes.</p>
<p class="indent"><a href="ch2.xhtml#ch2fig6">Figure 2-6</a> shows how constructors work on the call stack.</p>
<p class="figcap" id="ch2fig6"><span class="figure"><strong>FIGURE 2-6</strong></span></p>
<p class="figcap1">Constructors on the call stack</p>
<p class="imagef"><img src="images/fig02-06.jpg" alt="Images" /></p>
<h4 class="h4" id="ch2lev2sec10"><span id="page_118" epub:type="pagebreak"></span><strong>Rules for Constructors</strong></h4>
<p class="noindent">The following list summarizes the rules you’ll need to know for the exam (and to understand the rest of this section). You MUST remember these, so be sure to study them more than once.</p>
<p class="bullt"><img class="inline" src="images/box.jpg" alt="Images" />   Constructors can use any access modifier, including <code>private</code>. (A <code>private</code> constructor means only code within the class itself can instantiate an object of that type, so if the <code>private</code> constructor class wants to allow an instance of the class to be used, the class must provide a static method or variable that allows access to an instance created from within the class.)</p>
<p class="bull"><img class="inline" src="images/box.jpg" alt="Images" />   The constructor name must match the name of the class.</p>
<p class="bull"><img class="inline" src="images/box.jpg" alt="Images" />   Constructors must not have a return type.</p>
<p class="bull"><img class="inline" src="images/box.jpg" alt="Images" />   It’s legal (but stupid) to have a method with the same name as the class, but that doesn’t make it a constructor. If you see a return type, it’s a method rather than a constructor. In fact, you could have both a method and a constructor with the same name—the name of the class—in the same class, and that’s not a problem for Java. Be careful not to mistake a method for a constructor—be sure to look for a return type.</p>
<p class="bull"><img class="inline" src="images/box.jpg" alt="Images" />   If you don’t type a constructor into your class code, a default constructor will be automatically generated by the compiler.</p>
<p class="bull"><img class="inline" src="images/box.jpg" alt="Images" />   The default constructor is ALWAYS a no-arg constructor.</p>
<p class="bull"><img class="inline" src="images/box.jpg" alt="Images" />   If you want a no-arg constructor and you’ve typed any other constructor(s) into your class code, the compiler won’t provide the no-arg constructor (or any other constructor) for you. In other words, if you’ve typed in a constructor with arguments, you won’t have a no-arg constructor unless you typed it in yourself!</p>
<p class="bull"><img class="inline" src="images/box.jpg" alt="Images" />   Every constructor has, as its first statement, either a call to an overloaded constructor (<code>this()</code>) or a call to the superclass constructor (<code>super()</code>), although remember this call can be inserted by the compiler.</p>
<p class="bull"><img class="inline" src="images/box.jpg" alt="Images" />   If you do type in a constructor (as opposed to relying on the compiler-generated default constructor) and you do not type in the call to <code>super()</code> or a call to <code>this()</code>, the compiler will insert a no-arg call to <code>super()</code> for you as the very first statement in the constructor.</p>
<p class="bull"><img class="inline" src="images/box.jpg" alt="Images" />   A call to <code>super()</code> can either be a no-arg call or can include arguments passed to the super constructor.</p>
<p class="bull"><span id="page_119" epub:type="pagebreak"></span><img class="inline" src="images/box.jpg" alt="Images" />   A no-arg constructor is not necessarily the default (that is, compiler-supplied) constructor, although the default constructor is always a no-arg constructor. The default constructor is the one the compiler provides! Although the default constructor is always a no-arg constructor, you’re free to put in your own no-arg constructor.</p>
<p class="bull"><img class="inline" src="images/box.jpg" alt="Images" />   You cannot make a call to an instance method or access an instance variable until after the super constructor runs.</p>
<p class="bull"><img class="inline" src="images/box.jpg" alt="Images" />   Only static variables and methods can be accessed as part of the call to <code>super()</code> or <code>this()</code>. (Example: <code>super(Animal.NAME)</code> is OK, because <code>NAME</code> is declared as a static variable.)</p>
<p class="bull"><img class="inline" src="images/box.jpg" alt="Images" />   Abstract classes have constructors, and those constructors are always called when a concrete subclass is instantiated.</p>
<p class="bull"><img class="inline" src="images/box.jpg" alt="Images" />   Interfaces do not have constructors. Interfaces are not part of an object’s inheritance tree.</p>
<p class="bull"><img class="inline" src="images/box.jpg" alt="Images" />   The only way a constructor can be invoked is from within another constructor. In other words, you can’t write code that actually calls a constructor as follows:</p>
<p class="pre"><img src="images/un119-02.jpg" alt="Images" /></p>
<h4 class="h4" id="ch2lev2sec11"><strong>Determine Whether a Default Constructor Will Be Created</strong></h4>
<p class="noindent">The following example shows a <code>Horse</code> class with two constructors:</p>
<p class="pre"><img src="images/un119-03.jpg" alt="Images" /></p>
<p class="noindent">Will the compiler put in a default constructor for this class? No!</p>
<p class="indent">How about for the following variation of the class?</p>
<p class="pre"><img src="images/un119-04.jpg" alt="Images" /></p>
<p class="noindent">Now will the compiler insert a default constructor? No!</p>
<p class="indent"><span id="page_120" epub:type="pagebreak"></span>What about this class?</p>
<p class="pre"><code>class Horse { }</code></p>
<p class="noindent">Now we’re talking. The compiler will generate a default constructor for this class because the class doesn’t have any constructors defined.</p>
<p class="indent">Okay, what about this class?</p>
<p class="pre"><img src="images/un120-02.jpg" alt="Images" /></p>
<p class="noindent">It might look like the compiler won’t create a constructor, since one is already in the <code>Horse</code> class. Or is it? Take another look at the preceding <code>Horse</code> class.</p>
<p class="indent">What’s wrong with the <code>Horse()</code> constructor? It isn’t a constructor at all! It’s simply a method that happens to have the same name as the class. Remember, the return type is a dead giveaway that we’re looking at a method, not a constructor.</p>
<p class="noindentt"><strong>How do you know for sure whether a default constructor will be created?</strong> Because you didn’t write any constructors in your class.</p>
<p class="noindentt"><strong>How do you know what the default constructor will look like?</strong> Because…</p>
<p class="bullt"><img class="inline" src="images/box.jpg" alt="Images" />   The default constructor has the same access modifier as the class.</p>
<p class="bull"><img class="inline" src="images/box.jpg" alt="Images" />   The default constructor has no arguments.</p>
<p class="bullb"><img class="inline" src="images/box.jpg" alt="Images" />   The default constructor includes a no-arg call to the super constructor (<code>super()</code>).</p>
<p class="noindent"><a href="ch2.xhtml#ch2tab5">Table 2-5</a> shows what the compiler will (or won’t) generate for your class.</p>
<p class="tabcap" id="ch2tab5"><span class="table"><strong>TABLE 2-5</strong></span> Compiler-Generated Constructor Code</p>
<p class="imaget"><img src="images/tab02-05.jpg" alt="Images" /></p>
<p class="noindentt"><strong>What happens if the super constructor has arguments?</strong> Constructors can have arguments just as methods can, and if you try to invoke a method that takes, say, an <code>int</code>, but you don’t pass anything to the method, the compiler will complain as follows:</p>
<p class="pre"><img src="images/un120-03.jpg" alt="Images" /><span id="page_121" epub:type="pagebreak"></span></p>
<p class="indent">The compiler will complain that you can’t invoke <code>takeInt()</code> without passing an <code>int</code>. Of course, the compiler enjoys the occasional riddle, so the message it spits out on some versions of the JVM (your mileage may vary) is less than obvious:</p>
<p class="pre"><img src="images/un121-01.jpg" alt="Images" /></p>
<p class="noindent"><span id="page_122" epub:type="pagebreak"></span>But you get the idea. The bottom line is that there must be a match for the method. And by match, we mean the argument types must be able to accept the values or variables you’re passing and in the order you’re passing them. Which brings us back to constructors (and here you were thinking we’d never get there), which work exactly the same way.</p>
<p class="indent">So if your super constructor (that is, the constructor of your immediate superclass/parent) has arguments, you must type in the call to <code>super()</code>, supplying the appropriate arguments. Crucial point: if your superclass does not have a no-arg constructor, you must type a constructor in your class (the subclass) because you need a place to put in the call to <code>super()</code> with the appropriate arguments.</p>
<p class="indent">The following is an example of the problem:</p>
<p class="pre"><img src="images/un122-01.jpg" alt="Images" /></p>
<p class="noindent">And once again the compiler treats us with something like the stunning lucidity below:</p>
<p class="pre"><img src="images/un122-01a.jpg" alt="Images" /></p>
<p class="indent">If you’re lucky (and it’s a full moon), <em>your</em> compiler might be a little more explicit. But again, the problem is that there just isn’t a match for what we’re trying to invoke with <code>super()</code>—an <code>Animal</code> constructor with no arguments.</p>
<p class="indent">Another way to put this is that if your superclass does <em>not</em> have a no-arg constructor, then in your subclass you will not be able to use the default constructor supplied by the compiler. It’s that simple. Because the compiler can <em>only</em> put in a call to a no-arg <code>super()</code>, you won’t even be able to compile something like this:</p>
<p class="pre"><img src="images/un122-02.jpg" alt="Images" /></p>
<p class="indent"><span id="page_123" epub:type="pagebreak"></span>Trying to compile this code gives us exactly the same error we got when we put a constructor in the subclass with a call to the no-arg version of <code>super()</code>:</p>
<p class="pre"><img src="images/un123-01.jpg" alt="Images" /></p>
<p class="indent">In fact, the preceding <code>Clothing</code> and <code>TShirt</code> code is implicitly the same as the following code, where we’ve supplied a constructor for <code>TShirt</code> that’s identical to the default constructor supplied by the compiler:</p>
<p class="pre"><img src="images/un123-02.jpg" alt="Images" /></p>
<p class="indent">One last point on the whole default constructor thing (and it’s probably very obvious, but we have to say it or we’ll feel guilty for years), <strong><em>constructors are never inherited.</em></strong> They aren’t methods. They can’t be overridden (because they aren’t methods, and only instance methods can be overridden). So the type of constructor(s) your superclass has in no way determines the type of default constructor you’ll get. Some folks mistakenly believe that the default constructor somehow matches the super constructor, either by the arguments the default constructor will have (remember, the default constructor is always a no-arg) or by the arguments used in the compiler-supplied call to <code>super()</code>.</p>
<p class="indent">So although constructors can’t be overridden, they can—and often are—overloaded (which you’ve already seen).</p>
<h4 class="h4" id="ch2lev2sec12"><strong>Overloaded Constructors</strong></h4>
<p class="noindent">Overloading a constructor means typing in multiple versions of the constructor, each having a different argument list, like the following examples:</p>
<p class="pre"><img src="images/un123-03.jpg" alt="Images" /></p>
<p class="indent"><span id="page_124" epub:type="pagebreak"></span>The preceding <code>Foo</code> class has two overloaded constructors: one that takes a string and one with no arguments. Because there’s no code in the no-arg version, it’s actually identical to the default constructor the compiler supplies—but remember, since there’s already a constructor in this class (the one that takes a string), the compiler won’t supply a default constructor. If you want a no-arg constructor to overload the with-args version you already have, you’re going to have to type it yourself, just as in the <code>Foo</code> example.</p>
<p class="indent">Overloading a constructor is typically used to provide alternative ways for clients to instantiate objects of your class. For example, if a client knows the animal name, they can pass that to an <code>Animal</code> constructor that takes a string. But if they don’t know the name, the client can call the no-arg constructor and that constructor can supply a default name. Here’s what it looks like:</p>
<p class="pre"><img src="images/un124-01.jpg" alt="Images" /></p>
<p class="pre"><span id="page_125" epub:type="pagebreak"></span><img src="images/un125-01.jpg" alt="Images" /></p>
<p class="indent">There’s a lot going on in the preceding code. <a href="ch2.xhtml#ch2fig7">Figure 2-7</a> shows the call stack for constructor invocations when a constructor is overloaded. Take a look at the call stack, and then let’s walk through the code straight from the top.</p>
<p class="figcap" id="ch2fig7"><span class="figure"><strong>FIGURE 2-7</strong></span></p>
<p class="figcap1">Overloaded constructors on the call stack</p>
<p class="imagef"><img src="images/fig02-07.jpg" alt="Images" /></p>
<p class="bullt"><img class="inline" src="images/box.jpg" alt="Images" />   <strong>L</strong><strong>ine 2</strong> Declare a <code>String</code> instance variable name.</p>
<p class="bull"><img class="inline" src="images/box.jpg" alt="Images" />   <strong>L</strong><strong>ines 3–5</strong> Constructor that takes a <code>String</code> and assigns it to an instance variable name.</p>
<p class="bull"><img class="inline" src="images/box.jpg" alt="Images" />   <strong>L</strong><strong>ine 7</strong> Here’s where it gets fun. Assume every animal needs a name, but the client (calling code) might not always know what the name should be, so the <code>Animal</code> class will assign a random name. The no-arg constructor generates a name by invoking the <code>makeRandomName()</code> method.</p>
<p class="bull"><img class="inline" src="images/box.jpg" alt="Images" />   <strong>L</strong><strong>ine 8</strong> The no-arg constructor invokes its own overloaded constructor that takes a <code>String</code>, in effect calling it the same way it would be called if client code were doing a <code>new</code> to instantiate an object, passing it a <code>String</code> for the name. The overloaded invocation uses the keyword <code>this</code>, but uses it as though it were a method named <code>this()</code>. So line 8 is simply calling the constructor on line 3, passing it a randomly selected <code>String</code> rather than a client-code chosen name.</p>
<p class="bull"><span id="page_126" epub:type="pagebreak"></span><img class="inline" src="images/box.jpg" alt="Images" />   <strong>L</strong><strong>ine 11</strong> Notice that the <code>makeRandomName()</code> method is marked <code>static</code>! That’s because you cannot invoke an instance (in other words, nonstatic) method (or access an instance variable) until after the <code>super</code> constructor has run. And because the <code>super</code> constructor will be invoked from the constructor on line 3, rather than from the one on line 7, line 8 can use only a static method to generate the name. If we wanted all <code>animal</code>s not specifically named by the caller to have the same default name, say, “Fred,” then line 8 could have read <code>this("Fred");</code> rather than calling a method that returns a string with the randomly chosen name.</p>
<p class="bull"><img class="inline" src="images/box.jpg" alt="Images" />   <strong>L</strong><strong>ine 12</strong> This doesn’t have anything to do with constructors, but since we’re all here to learn, it generates a random integer between 0 and 4.</p>
<p class="bull"><img class="inline" src="images/box.jpg" alt="Images" />   <strong>L</strong><strong>ine 13</strong> Weird syntax, we know. We’re creating a new <code>String</code> object (just a single <code>String</code> instance), but we want the string to be selected randomly from a list. Except we don’t have the list, so we need to make it. So in that one line of code we</p>
<p class="numlist-1">1.   Declare a <code>String</code> variable name.</p>
<p class="numlist-1">2.   Create a <code>String</code> array (anonymously—we don’t assign the array itself to a variable).</p>
<p class="numlist-1">3.   Retrieve the string at index <code>[x]</code> (x being the random number generated on line 12) of the newly created <code>String</code> array.</p>
<p class="numlist-1">4.   Assign the string retrieved from the array to the declared instance variable name. (Throwing in unusual syntax, especially for code wholly unrelated to the real question, is in the spirit of the exam. Don’t be startled! Okay, be startled, but then just say to yourself, “Whoa!” and get on with it.)</p>
<p class="bull"><img class="inline" src="images/box.jpg" alt="Images" />   <strong>L</strong><strong>ine 18</strong> We’re invoking the no-arg version of the constructor (causing a random name from the list to be passed to the other constructor).</p>
<p class="bullb"><img class="inline" src="images/box.jpg" alt="Images" />   <strong>L</strong><strong>ine 20</strong> We’re invoking the overloaded constructor that takes a string representing the name.</p>
<p class="indent">The key point to get from this code example is in line 8. Rather than calling <code>super()</code>, we’re calling <code>this()</code>, and <code>this()</code> always means a call to another constructor in the same class. Okay, fine, but what happens after the call to <code>this()</code>? Sooner or later the <code>super()</code> constructor gets called, right? Yes, indeed. A call to <code>this()</code> just means you’re delaying the inevitable. Some constructor, somewhere, must make the call to <code>super()</code>.</p>
<p class="ind-bq"><strong>Key Rule: The first line in a constructor must be a call to super()</strong><strong>or a call to this()</strong><strong>.</strong></p>
<p class="noindent"><span id="page_127" epub:type="pagebreak"></span>No exceptions. If you have neither of those calls in your constructor, the compiler will insert the no-arg call to <code>super()</code>. In other words, if constructor <code>A()</code> has a call to <code>this()</code>, the compiler knows that constructor <code>A()</code> will not be the one to invoke <code>super()</code>.</p>
<p class="indent">The preceding rule means a constructor can never have both a call to <code>super()</code> and a call to <code>this()</code>. Because each of those calls must be the first statement in a constructor, you can’t legally use both in the same constructor. That also means the compiler will not put a call to <code>super()</code> in any constructor that has a call to <code>this()</code>.</p>
<p class="indent">Thought question: What do you think will happen if you try to compile the following code?</p>
<p class="pre"><img src="images/un127-01.jpg" alt="Images" /></p>
<p class="indent">Java 8 compilers should catch the problem in this code and report an error, something like:</p>
<p class="pre"><img src="images/un127-01a.jpg" alt="Images" /></p>
<p class="indent">Older compilers may not actually catch the problem. They might assume you know what you’re doing. Can you spot the flaw? Given that a <code>super</code> constructor must always be called, where would the call to <code>super()</code> go? Remember, the compiler won’t put in a default constructor if you’ve already got one or more constructors in your class. And when the compiler doesn’t put in a default constructor, it still inserts a call to <code>super()</code> in any constructor that doesn’t explicitly have a call to the <code>super</code> constructor—unless, that is, the constructor already has a call to <code>this()</code>. So in the preceding code, where can <code>super()</code> go? The only two constructors in the class both have calls to <code>this()</code>, and, in fact, you’ll get exactly what you’d get if you typed the following method code:</p>
<p class="pre"><img src="images/un127-02.jpg" alt="Images" /></p>
<p class="indent"><span id="page_128" epub:type="pagebreak"></span>Now can you see the problem? Of course you can. The stack explodes! It gets higher and higher and higher until it just bursts open and method code goes spilling out, oozing from the JVM right onto the floor. Two overloaded constructors both calling <code>this()</code> are two constructors calling each other—over and over and over, resulting in this:</p>
<p class="pre"><img src="images/un128-01.jpg" alt="Images" /></p>
<p class="indent">The benefit of having overloaded constructors is that you offer flexible ways to instantiate objects from your class. The benefit of having one constructor invoke another overloaded constructor is to avoid code duplication. In the <code>Animal</code> example, there wasn’t any code other than setting the name, but imagine if after line 4 there was still more work to be done in the constructor. By putting all the other constructor work in just one constructor, and then having the other constructors invoke it, you don’t have to write and maintain multiple versions of that other important constructor code. Basically, each of the other not-the-real-one overloaded constructors will call another overloaded constructor, passing it whatever data it needs (data the client code didn’t supply).</p>
<p class="indent">Constructors and instantiation become even more exciting (just when you thought it was safe) when you get to inner classes, but we know you can stand to have only so much fun in one chapter, and besides, you don’t have to deal with inner classes until <a href="ch7.xhtml#ch7">Chapter 7</a>.</p>
<p class="title-o"><span class="white"><strong>CERTIFICATION OBJECTIVE</strong></span></p>
<h3 class="h3" id="ch2lev1sec9"><strong>Singleton Design Pattern (OCP Objective 1.5)</strong></h3>
<p class="noindentb"><em>1.5   Create and use singleton classes and immutable classes.</em></p>
<p class="indent">We just finished discussing how constructors play a role whenever new objects are created. In this section, we’ll discuss the singleton design pattern that allows us to ensure we only have one instance of a class within an application. (Note: These days not everyone is a fan of the singleton pattern, but that’s a discussion for another time.) <em>Singleton</em> is called a creational design pattern because it deals with creating objects. But wait, what’s this “design pattern”?</p>
<h4 class="h4" id="ch2lev2sec13"><span id="page_129" epub:type="pagebreak"></span><strong>What Is a Design Pattern?</strong></h4>
<p class="noindent">Wikipedia currently defines a design pattern as “a general reusable solution to a commonly occurring problem within a given context.” What does that mean? Programmers often encounter the same problem repeatedly. Rather than have everyone come up with their own solution to common programming issues, we use a “best practice”–type solution that has been documented and proven to work. The word “general” is important. We can’t just copy and paste a design pattern into our code. It’s just an idea. We should write an implementation for it and put that in our code.</p>
<p class="indent">Using a design pattern has a few advantages. We get to use a solution that is known to work. The tradeoffs, if any, are well documented, so we don’t stumble over problems that have already been solved. Design patterns also serve as communication aids. Your boss can say, “We will use a singleton,” and that one word is enough to tell you what is expected.</p>
<p class="indent">When books or web pages document patterns, they do so using a consistent format. We pay homage to this universal format by including sections for the “Problem,” “Solution,” and “Benefits” of the singleton pattern. The “Problem” section explains why we need the pattern—what problem we are trying to solve. The “Solution” section explains how to implement the pattern. The “Benefits” section reviews why we need the pattern and how it has helped us solve the problem. Some of the benefits are hinted at in the “Problem” section. Others are additional benefits that come from the pattern.</p>
<p class="text-icon"><img src="images/onjob.jpg" alt="Images" /></p>
<p class="noindentb"><strong>The OCP 8 exam covers only one pattern; this is just to get your feet wet. Whole books have been written on the topic of design patterns. <strong>Head First Design Patterns</strong> (O’Reilly Media, 2004) covers more patterns. And the most famous book on patterns—<strong>Design Patterns: Elements of Reusable Object-Oriented Software</strong> (Addison-Wesley Professional, 1994), also known as “Gang of Four”—covers 23 design patterns. You may notice that these books are more than 10 years old. That’s because the classic patterns haven’t changed.</strong></p>
<h4 class="h4" id="ch2lev2sec14"><strong>Problem</strong></h4>
<p class="noindent">Let’s suppose we’re putting on a show. We’re going to perform the show once, and we only have a few seats in the theater.</p>
<p class="pre"><img src="images/un129-01.jpg" alt="Images" /></p>
<p class="pre"><span id="page_130" epub:type="pagebreak"></span><img src="images/un130-01.jpg" alt="Images" /></p>
<p class="noindent">This code prints out <code>true</code> twice. That’s a problem. We just put two people in the same seat. Why? We created a new <code>Show</code> object every time we needed it. Even though we want to use the same theater and seats, <code>Show</code> deals with a new set of seats each time, which means we’ve double-booked seats.</p>
<h4 class="h4" id="ch2lev2sec15"><strong>Solution</strong></h4>
<p class="noindent">There are a few ways to implement the singleton pattern. Here’s the simplest:</p>
<p class="pre"><img src="images/un130-02.jpg" alt="Images" /></p>
<p class="pre"><span id="page_131" epub:type="pagebreak"></span><img src="images/un131-01.jpg" alt="Images" /></p>
<p class="noindent">Now the code prints <code>true</code> and <code>false</code>. Much better! We are no longer going to have two people sitting in the same seat. The bolded bits in the code call attention to the implementation of the singleton pattern.</p>
<p class="indent">The key parts of the singleton pattern are</p>
<p class="bullt"><img class="inline" src="images/box.jpg" alt="Images" />   A private static variable to store the single instance called the singleton. This variable is usually final to keep developers from accidentally changing it.</p>
<p class="bull"><img class="inline" src="images/box.jpg" alt="Images" />   A public static method for callers to get a reference to the instance.</p>
<p class="bullb"><img class="inline" src="images/box.jpg" alt="Images" />   A private constructor so no callers can instantiate the object directly.</p>
<p class="indent">Remember, the code doesn’t create a new <code>Show</code> each time, but merely returns the singleton instance of <code>Show</code> each time <code>getInstance()</code> is called.</p>
<p class="indent">To understand this a little better, let’s consider what happens if we change parts of the code.</p>
<p class="indent">If the constructor weren’t private, we wouldn’t have a singleton. Callers would be free to ignore <code>getInstance()</code> and instantiate their own instances, which would leave us with multiple instances in the program and defeat the purpose entirely.</p>
<p class="indent">If <code>getInstance()</code> weren’t public, we would still have a singleton. However, it wouldn’t be as useful because only methods in the same package would be able to use the singleton.</p>
<p class="indent">If <code>getInstance()</code> weren’t static, we’d have a bigger problem. Callers couldn’t instantiate the class directly, which means they wouldn’t be able to call <code>getInstance()</code> at all.</p>
<p class="indent">If <code>INSTANCE</code> weren’t static and final, we could have multiple instances at different points in time. These keywords signal that we assign the field once and it stays that way for the life of the program.</p>
<p class="indent">When talking about design patterns, it is also common to communicate the pattern in diagram form. The singleton pattern diagram looks like this:</p>
<p class="image"><img src="images/t0131-01.jpg" alt="Images" /></p>
<p class="text-icon"><img src="images/onjob.jpg" alt="Images" /></p>
<p class="noindentb"><span id="page_132" epub:type="pagebreak"></span><strong><em>The diagrams use a format called Unified Modeling Language (UML). The diagrams in this book use some aspects of UML, such as a box with three sections representing each class. Actual UML uses more notation, such as showing public versus private visibility. You can think of this as faux-UML.</em></strong></p>
<p class="indent">As long as the method in the diagram keeps the same signature, we can change our logic to other implementations of the singleton pattern. One “feature” of the above implementation is that it creates the <code>Show</code> object before we need it. This is called <em>eager initialization,</em> which is good if the object isn’t expensive to create or we know it will be needed every time the program runs. Sometimes, however, we want to create the object only on the first use. This is called <em>lazy</em> initialization.</p>
<p class="pre"><img src="images/un132-01.jpg" alt="Images" /></p>
<p class="noindent">In this case, <code>INSTANCE</code> isn’t set to be a <code>Show</code> until the first time <code>getInstance()</code> is called. Walking through what happens, the first time <code>getInstance()</code> is called, Java sees <code>INSTANCE</code> is still null and creates the singleton. The second time <code>getInstance()</code> is called, Java sees <code>INSTANCE</code> has already been set and simply returns it. In this example, <code>INSTANCE</code> isn’t final because that would prevent the code from compiling.</p>
<p class="text-icon"><img src="images/onjob.jpg" alt="Images" /></p>
<p class="noindentb"><strong>The singleton code here assumes you are only running one thread at a time. It is NOT thread-safe. What if this were a web site and two users managed to be booking a seat at the exact same time? If <strong><em>getInstance()</em></strong> were running at the exact same time, both of them could see that INSTANCE was null and create a new <strong><em>Show</em></strong> at the same time. There are a few ways to solve this. One is to add <strong><em>synchronized</em></strong> to the <strong><em>getInstance()</em></strong> method. This works, but comes with a small performance hit. We’re getting way beyond the scope of the exam, but you can Google “double checked locked pattern” for more information.</strong></p>
<p class="indent"><span id="page_133" epub:type="pagebreak"></span>You might have noticed that the code for <code>getInstance()</code>can get a bit complicated. Java 5 gave us a much shorter way of creating a singleton:</p>
<p class="pre"><img src="images/un133-01.jpg" alt="Images" /></p>
<p class="indent">Short and sweet. By definition, there is only one instance of an enum constant. You are probably wondering why we’ve had this whole discussion of the singleton pattern when you can write it so easily. The main reason is that enums were introduced with Java 5, and there is a ton of older code out there that you need to be able to understand. Another reason is that sometimes you still need the older versions of the pattern.</p>
<h4 class="h4" id="ch2lev2sec16"><strong>Benefits</strong></h4>
<p class="noindent">Benefits of the singleton pattern include the following:</p>
<p class="bullt"><img class="inline" src="images/box.jpg" alt="Images" />   The primary benefit is that there is only one instance of the object in the program. When an object’s instance variables are keeping track of information that is used across the program, it’s useful. For example, consider a web site visitor counter. You only want one count that is shared.</p>
<p class="bull"><img class="inline" src="images/box.jpg" alt="Images" />   Another benefit is performance. Some objects are expensive to create; for example, maybe we need to make a database call to look up the state for the object.</p>
<p class="title-o"><span id="page_134" epub:type="pagebreak"></span><span class="white"><strong>CERTIFICATION OBJECTIVE</strong></span></p>
<h3 class="h3" id="ch2lev1sec10"><strong>Immutable Classes (OCP Objective 1.5)</strong></h3>
<p class="noindentb"><em>1.5   Create and use singleton classes and immutable classes.</em></p>
<p class="indent">Immutable classes aren’t a new idea, but they’re new to the OCP exam. Because they are inherently thread-safe, immutable classes are particularly useful in applications that include concurrency and/or parallelism. In this world of big data and fast data, the need for concurrency and parallelism is on the rise, so adding immutable classes to the exam is a timely choice.</p>
<p class="indent">You’re already familiar with so-called “immutable classes” because String is a great example of one! One way of looking at the String class is that you might want to create an object that has a string value AND you want to allow others to have access to your string’s value, but you don’t want to let anyone (including you) change the object’s value. That’s exactly what a String object allows.</p>
<p class="indent">You can create your own “immutable classes” whenever you have a design goal similar to the one described above—in other words, whenever you want to create a class whose objects’ values are immutable. In addition, usually when you want a type that creates only immutable objects, you won’t want people to be able to extend your class and undo your immutability goal, so immutable classes should be marked <code>final</code>. Again, this is just like the String class (which is also a <code>final</code> class).</p>
<p class="indent">Other than the immutability of values and their “final-ness,” there is nothing unique about these classes. You can design them to be instantiated via constructors or by using a factory method. They can have behavior like the String class has. The only difference is that—by definition—the class’s object’s variables can’t be changed. Let’s look at what steps are necessary to develop an immutable class.</p>
<p class="indent">Imagine your team is developing an audio synthesizer app for Android. An important part of the synth software is the ADSR envelope. (ADSR stands for attack, decay, sustain, and release.) A given ADSR envelope describes a unique sound. You want your users to be able to create, save, and share the custom ADSR envelope objects they’ve created, but your users don’t want anyone to be able to alter their unique sonic creations. Below is the code for our ADSR immutable class. (Note: For the sake of brevity, we omitted the code for the sustain and release values, but it will be the same as the code we show for attack and decay.)</p>
<p class="pre"><img src="images/un134-01.jpg" alt="Images" /></p>
<p class="pre"><span id="page_135" epub:type="pagebreak"></span><img src="images/un135-01.jpg" alt="Images" /></p>
<p class="indent">The code above allows the following:</p>
<p class="bullt"><img class="inline" src="images/box.jpg" alt="Images" />   You can build your own immutable ADSR objects with secret values.</p>
<p class="bull"><img class="inline" src="images/box.jpg" alt="Images" />   You can share your ADSR objects.</p>
<p class="bullb"><img class="inline" src="images/box.jpg" alt="Images" />   Your users can read the name field of your objects, but they can’t mutate your objects.</p>
<p class="indent">Does this all make sense? Does the code look bulletproof? There is a problem with the way we implemented the ADSR class! Let’s look at a test class:</p>
<p class="pre"><img src="images/un135-02.jpg" alt="Images" /></p>
<p class="noindent">which produces the output:</p>
<p class="pre"><img src="images/un135-02a.jpg" alt="Images" /></p>
<p class="indent">Oops! Our constructor is using the same <code>StringBuilder</code> object as the one used by the method that invoked the constructor. (Note: If you’re thinking “Don’t use a <code>StringBuilder</code>, use a <code>String</code>” to give yourself extra points. We used a <span id="page_136" epub:type="pagebreak"></span><code>StringBuilder</code> to demonstrate how to deal with instance variables that are of a mutable, nonprimitive type.) So we gotta fix that! Here’s the fixed version of the ADSR class:</p>
<p class="pre"><img src="images/un136-01.jpg" alt="Images" /></p>
<p class="indent">Much better! Here’s a list of things to do to create an immutable class:</p>
<p class="numlist">1.   Mark the class final so that it cannot be extended.</p>
<p class="numlist">2.   Mark its variables private and final.</p>
<p class="numlist">3.   If the constructor takes any mutable objects as arguments, make new copies of those objects in the constructor.</p>
<p class="numlist"><span id="page_137" epub:type="pagebreak"></span>4.   Do NOT provide any setter methods!</p>
<p class="numlist">5.   If any of the getter methods return a mutable object reference, make a copy of the actual object, and return a reference to the copy.</p>
<p class="indent">Notice that points 3 and 5 both discuss making copies of objects. This idea is an aspect of what is sometimes referred to as “defensive copying.” If some of this section reminds you of ideas in the “Encapsulation” section earlier in this chapter, congratulations! An immutable class is—by definition—extremely well encapsulated.</p>
<p class="indent">In the real world there are some more advanced ideas associated with immutable classes, but if you understand this section, you’ll be fine for the exam.</p>
<p class="text-icon"><img src="images/onjob.jpg" alt="Images" /></p>
<p class="noindent"><strong>In this section we’ve often put quotes around the phrase “immutable class” because it’s a bit of a misnomer. More accurately, what we’re talking about here are classes whose objects are immutable.</strong></p>
<p class="title-o"><span class="white"><strong>CERTIFICATION OBJECTIVE</strong></span></p>
<h3 class="h3" id="ch2lev1sec11"><strong>Initialization Blocks (OCP Objective 1.6)</strong></h3>
<p class="noindentb"><em>1.6   Develop code that uses static keyword (sic) on initialize blocks, variables, methods, and classes.</em></p>
<p class="indent">We’ve talked about two places in a class where you can put code that performs operations: methods and constructors. There is also a third place in a Java program where operations can be performed: initialization blocks. Static initialization blocks run when the class is first loaded, and instance initialization blocks run whenever an instance is created (a bit similar to a constructor). Let’s look at an example:</p>
<p class="pre"><img src="images/un137-01.jpg" alt="Images" /></p>
<p class="indent">As you can see, the syntax for initialization blocks is pretty terse. They don’t have names, they can’t take arguments, and they don’t return anything. A <em>static</em> initialization block runs <em>once</em> when the class is first loaded. An <em>instance</em> initialization <span id="page_138" epub:type="pagebreak"></span>block runs once <em>every time a new instance is created</em>. Remember when we talked about the order in which constructor code executed? Instance <code>init</code> block code runs right after the call to <code>super()</code> in a constructor and before any of the other code in the constructor—in other words, after all <code>super</code> constructors have run.</p>
<p class="indent">You can have many initialization blocks in a class. It is important to note that unlike methods or constructors, <em>the order in which initialization blocks appear in a class matters</em>. When it’s time for initialization blocks to run, if a class has more than one, they will run in the order in which they appear in the class file—in other words, from the top down. Based on the rules we just discussed, can you determine the output of the following program?</p>
<p class="pre"><img src="images/un138-01.jpg" alt="Images" /></p>
<p class="indent">To figure this out, remember these rules:</p>
<p class="bullt"><img class="inline" src="images/box.jpg" alt="Images" />   <code>i</code><code>nit</code> blocks execute in the order in which they appear.</p>
<p class="bull"><img class="inline" src="images/box.jpg" alt="Images" />   Static <code>init</code> blocks run once, when the class is first loaded.</p>
<p class="bull"><img class="inline" src="images/box.jpg" alt="Images" />   Instance <code>init</code> blocks run every time a class instance is created.</p>
<p class="bullb"><img class="inline" src="images/box.jpg" alt="Images" />   Instance <code>init</code> blocks run after the constructor’s call to <code>super()</code>.</p>
<p class="indent">With those rules in mind, the following output should make sense:</p>
<p class="pre"><img src="images/un138-02.jpg" alt="Images" /></p>
<p class="indent"><span id="page_139" epub:type="pagebreak"></span>As you can see, the instance <code>init</code> blocks each ran twice. Instance <code>init</code> blocks are often used as a place to put code that all the constructors in a class should share. That way, the code doesn’t have to be duplicated across constructors.</p>
<p class="indent">Finally, if you make a mistake in your static <code>init</code> block, the JVM can throw an <code>ExceptionInInitializerError</code>. Let’s look at an example:</p>
<p class="pre"><img src="images/un139-01.jpg" alt="Images" /></p>
<p class="noindent">It produces something like this:</p>
<p class="pre"><img src="images/un139-02.jpg" alt="Images" /></p>
<div class="side">
<p class="exam"><img src="images/exam.jpg" alt="Images" /></p>
</div>
<div class="side1">
<p class="indentb"><strong><em>By convention, <code>init</code> blocks usually appear near the top of the class file, somewhere around the constructors. However, this is the OCP exam we’re talking about. Don’t be surprised if you find an <code>init</code> block tucked in between a couple of methods, looking for all the world like a compiler error waiting to happen!</em></strong></p>
</div>
<p class="title-o"><span class="white"><strong>CERTIFICATION OBJECTIVE</strong></span></p>
<h3 class="h3" id="ch2lev1sec12"><strong>Statics (OCP Objective 1.6)</strong></h3>
<p class="noindentb"><em>1.6   Develop code that uses static keyword (sic) on initialize blocks, variables, methods, and classes.</em></p>
<h4 class="h4" id="ch2lev2sec17"><strong>Static Variables and Methods</strong></h4>
<p class="noindent">The <code>static</code> modifier has such a profound impact on the behavior of a method or variable that we’re treating it as a concept entirely separate from the other modifiers. To understand the way a <code>static</code> member works, we’ll look first at a reason for <span id="page_140" epub:type="pagebreak"></span>using one. Imagine you’ve got a utility class or interface with a method that always runs the same way; its sole function is to return, say, a random number. It wouldn’t matter which instance of the class performed the method—it would always behave exactly the same way. In other words, the method’s behavior has no dependency on the state (instance variable values) of an object. So why, then, do you need an object when the method will never be instance-specific? Why not just ask the type itself to run the method?</p>
<p class="indent">Let’s imagine another scenario: Suppose you want to keep a running count of all instances instantiated from a particular class. Where do you actually keep that variable? It won’t work to keep it as an instance variable within the class whose instances you’re tracking, because the count will just be initialized back to a default value with each new instance. The answer to both the utility-method-always-runs-the-same scenario and the keep-a-running-total-of-instances scenario is to use the <code>static</code> modifier. Variables and methods marked <code>static</code> belong to the type, rather than to any particular instance. In fact, for classes, you can use a <code>static</code> method or variable without having any instances of that class at all. You need only have the type available to be able to invoke a <code>static</code> method or access a <code>static</code> variable. <code>static</code> variables, too, can be accessed without having an instance of a class. But if there are instances, a <code>static</code> variable of a class will be shared by all instances of that class; there is only one copy.</p>
<p class="indent">The following code declares and uses a <code>static</code> counter variable:</p>
<p class="pre"><img src="images/un140-01.jpg" alt="Images" /></p>
<p class="indent">In the preceding code, the <code>static frogCount</code> variable is set to zero when the <code>Frog</code> class is first loaded by the JVM, before any <code>Frog</code> instances are created! (By the way, you don’t actually need to initialize a static variable to zero; static variables get the same default values instance variables get, but it’s good practice to initialize <span id="page_141" epub:type="pagebreak"></span>them anyway.) Whenever a <code>Frog</code> instance is created, the <code>Frog</code> constructor runs and increments the <code>static frogCount</code> variable. When this code executes, three <code>Frog</code> instances are created in <code>main()</code>, and the result is</p>
<p class="pre"><code>Frog count is now 3</code></p>
<p class="indent">Now imagine what would happen if <code>frogCount</code> were an instance variable (in other words, nonstatic):</p>
<p class="pre"><img src="images/un141-02.jpg" alt="Images" /></p>
<p class="noindent">When this code executes, it should still create three <code>Frog</code> instances in <code>main()</code>, but the result is…a compiler error! We can’t get this code to compile, let alone run.</p>
<p class="pre"><img src="images/un141-03.jpg" alt="Images" /></p>
<p class="indent">The JVM doesn’t know which Frog object’s <code>frogCount</code> you’re trying to access. The problem is that <code>main()</code> is itself a <code>static</code> method and thus isn’t running against any particular instance of the class; instead it’s running on the class itself. A <code>static</code> method can’t access a nonstatic (instance) variable because there is no instance! That’s not to say there aren’t instances of the class alive on the heap, but rather that even if there are, the <code>static</code> method doesn’t know anything about them. The same applies to instance methods; a <code>static</code> method can’t directly invoke a nonstatic method. Think static = class, nonstatic = instance. Making the method called by the JVM (<code>main()</code>) a <code>static</code> method means the JVM doesn’t have to create an instance of your class just to start running code.</p>
<div class="side">
<p class="exam"><span id="page_142" epub:type="pagebreak"></span><img src="images/exam.jpg" alt="Images" /></p>
</div>
<div class="side1">
<p class="indentb"><strong><em>One of the mistakes most often made by new Java programmers is attempting to access an instance variable (which means nonstatic variable) from the static <code>main()</code> method (which doesn’t know anything about any instances, so it can’t access the variable). The following code is an example of illegal access of a nonstatic variable from a <code>static</code> method:</em></strong></p>
<p class="pre"><img src="images/un142-01.jpg" alt="Images" /></p>
<p class="noindent"><strong><em>Understand that this code will never compile, because you can’t access a nonstatic (instance) variable from a <code>static</code> method. Just think of the compiler saying, "Hey, I have no idea which Foo object’s x variable you’re trying to print!" Remember, it’s the class running the <code>main()</code> method, not an instance of the class.</em></strong></p>
<p class="indent"><strong><em>Of course, the tricky part for the exam is that the question won’t look as obvious as the preceding code. The problem you’re being tested for—accessing a nonstatic variable from a <code>static</code> method—will be buried in code that might appear to be testing something else. For example, the preceding code would be more likely to appear as</em></strong></p>
<p class="pre"><img src="images/un142-02.jpg" alt="Images" /></p>
<p class="indent"><strong><em>So while you’re trying to follow the logic, the real issue is that x and y can’t be used within <code>main()</code> because <code>x</code> and <code>y</code> are instance, not <code>static</code>, variables! The same applies for accessing nonstatic methods from a <code>static</code> method. The rule is that a <code>static</code> method of a class can’t access a nonstatic (instance) method or variable of its own class.</em></strong></p>
</div>
<h5 class="h5"><span id="page_143" epub:type="pagebreak"></span>Accessing Static Methods and Variables</h5>
<p class="noindent">Since you don’t need to have an instance in order to invoke a static method or access a static variable, how do you invoke or use a <code>static</code> member? What’s 146the syntax? We know that with a regular old instance method, you use the dot operator on a reference to an instance:</p>
<p class="pre"><img src="images/un143-01.jpg" alt="Images" /></p>
<p class="indent">In the preceding code, we instantiate a <code>Frog</code>, assign it to the reference variable <code>f</code>, and then use that <code>f</code> reference to invoke a method on the <code>Frog</code> instance we just created. In other words, the <code>getFrogSize()</code> method is being invoked on a specific <code>Frog</code> object on the heap.</p>
<p class="indent">But this approach (using a reference to an object) isn’t appropriate for accessing a <code>static</code> method because there might not be any instances of the class at all! So the way we access a <code>static</code> method (or <code>static</code> variable) is to use the dot operator on the type name, as opposed to using it on a reference to an instance, as follows:</p>
<p class="pre"><img src="images/un143-02.jpg" alt="Images" /></p>
<p class="pre"><span id="page_144" epub:type="pagebreak"></span><img src="images/un144-01.jpg" alt="Images" /></p>
<p class="indent">But just to make it really confusing, the Java language also allows you to use an object reference variable to access a <code>static</code> member. Did you catch the last line of <code>main()</code>? It included this invocation:</p>
<p class="pre"><code><strong>f.getCount();</strong> // Access a static using an instance variable</code></p>
<p class="indent">In the preceding code, we instantiate a <code>Frog</code>, assign the new <code>Frog</code> object to the reference variable <code>f</code>, and then use the <code>f</code> reference to invoke a <code>static</code> method! But even though we are using a specific <code>Frog</code> instance to access the <code>static</code> method, the rules haven’t changed. This is merely a syntax trick to let you use an object reference variable (but not the object it refers to) to get to a <code>static</code> method or variable, but the <code>static</code> member is still unaware of the particular instance used to invoke the <code>static</code> member. In the <code>Frog</code> example, the compiler knows that the reference variable <code>f</code> is of type <code>Frog</code>, and so the <code>Frog</code> class <code>static</code> method is run with no awareness or concern for the <code>Frog</code> instance at the other end of the <code>f</code> reference. In other words, the compiler cares only that reference variable <code>f</code> is declared as type <code>Frog</code>.</p>
<p class="indent">Invoking static methods from interfaces is almost the same as invoking static methods from classes, except the “instance variable syntax trick” just discussed works only for static methods in classes. The following code demonstrates how interface static methods can and cannot be invoked:</p>
<p class="pre"><img src="images/un144-03.jpg" alt="Images" /></p>
<p class="pre"><span id="page_145" epub:type="pagebreak"></span><img src="images/un145-01.jpg" alt="Images" /></p>
<p class="indent">Let’s review the code:</p>
<p class="bullt"><img class="inline" src="images/box.jpg" alt="Images" />   <strong>L</strong><strong>ine 1</strong> is a legal invocation of an interface’s <code>default</code> method.</p>
<p class="bull"><img class="inline" src="images/box.jpg" alt="Images" />   <strong>L</strong><strong>ine 2</strong> is an <strong>illegal</strong> attempt to invoke an interface’s <code>static</code> method.</p>
<p class="bull"><img class="inline" src="images/box.jpg" alt="Images" />   <strong>L</strong><strong>ine 3</strong> is THE legal way to invoke an interface’s <code>static</code> method.</p>
<p class="bullb"><img class="inline" src="images/box.jpg" alt="Images" />   <strong>L</strong><strong>ine 4</strong> is another <strong>illegal</strong> attempt to invoke an interface’s <code>static</code> method.</p>
<p class="indent"><a href="ch2.xhtml#ch2fig8">Figure 2-8</a> illustrates the effects of the <code>static</code> modifier on methods and variables.</p>
<p class="figcap" id="ch2fig8"><span class="figure"><strong>FIGURE 2-8</strong></span></p>
<p class="figcap1">The effects of <code>static</code> on methods and variables</p>
<p class="imagef"><img src="images/fig02-08.jpg" alt="Images" /></p>
<p class="indent"><span id="page_146" epub:type="pagebreak"></span>Finally, remember that <em>static</em><em> methods can’t be overridden</em>! This doesn’t mean they can’t be redefined in a subclass, but redefining and overriding aren’t the same thing. Let’s look at an example of a redefined (remember, not overridden) <code>static</code> method:</p>
<p class="pre"><img src="images/un146-01.jpg" alt="Images" /></p>
<p class="indent">Remember, the syntax a <code>[x].doStuff()</code> is just a shortcut (the syntax trick)—the compiler is going to substitute something like <code>Animal.doStuff()</code> instead. Notice also that you can invoke a <code>static</code> method by using the class name.</p>
<p class="indent">We also didn’t use the enhanced <code>for</code> loop here, even though we could have. Expect to see a mix of both Java 1.4 and Java 5–8 coding styles and practices on the exam.</p>
<h3 class="h3b" id="ch2lev1sec13">CERTIFICATION SUMMARY</h3>
<hr/>
<p class="noindent">We started the chapter by discussing the importance of encapsulation in good OO design, and then we talked about how good encapsulation is implemented: with private instance variables and public getters and setters.</p>
<p class="indent">Next, we covered the importance of inheritance, so that you can grasp overriding, overloading, polymorphism, reference casting, return types, and constructors.</p>
<p class="indent">We covered IS-A and HAS-A. IS-A is implemented using inheritance, and HAS-A is implemented by using instance variables that refer to other objects.</p>
<p class="indent"><span id="page_147" epub:type="pagebreak"></span>Polymorphism was next. Although a reference variable’s type can’t be changed, it can be used to refer to an object whose type is a subtype of its own. We learned how to determine what methods are invocable for a given reference variable.</p>
<p class="indent">We looked at the difference between overridden and overloaded methods, learning that an overridden method occurs when a subtype inherits a method from a supertype and then reimplements the method to add more specialized behavior. We learned that, at runtime, the JVM will invoke the subtype version on an instance of a subtype and the supertype version on an instance of the supertype. <code>Abstract</code> methods must be “overridden” (technically, <code>abstract</code> methods must be implemented, as opposed to overridden, since there really isn’t anything to override).</p>
<p class="indent">We saw that overriding methods must declare the same argument list and return type or they can return a subtype of the declared return type of the supertype’s overridden method), and that the access modifier can’t be more restrictive. The overriding method also can’t throw any new or broader checked exceptions that weren’t declared in the overridden method. You also learned that the overridden method can be invoked using the syntax <code>super.doSomething();</code>.</p>
<p class="indent">Overloaded methods let you reuse the same method name in a class, but with different arguments (and, optionally, a different return type). Whereas overriding methods must not change the argument list, overloaded methods must. But unlike overriding methods, overloaded methods are free to vary the return type, access modifier, and declared exceptions any way they like.</p>
<p class="indent">We ended our discussions of overriding by looking at the <code>@Override</code> annotation. You can use this annotation to tell the compiler that you intend for the method that follows the annotation to either be an override of a superclass method or an implementation of an interface method. The compiler will tell you if you’re doing it wrong.</p>
<p class="indent">We learned the mechanics of casting (mostly downcasting) reference variables and when it’s necessary to do so.</p>
<p class="indent">Implementing interfaces came next. An interface describes a <em>contract</em> that the implementing class must follow. The rules for implementing an interface are similar to those for extending an <code>abstract</code> class. As of Java 8, interfaces can have concrete methods, which are labeled <code>default</code> or <code>static</code>. Also, remember that a class can implement more than one interface and that interfaces can extend another interface.</p>
<p class="indent">We also looked at method return types and saw that you can declare any return type you like (assuming you have access to a class for an object reference return type), unless you’re overriding a method. Barring a covariant return, an overriding method must have the same return type as the overridden method of the superclass. We saw that, although overriding methods must not change the return type, overloaded methods can (as long as they also change the argument list).</p>
<p class="indent"><span id="page_148" epub:type="pagebreak"></span>Finally, you learned that it is legal to return any value or variable that can be implicitly converted to the declared return type. So, for example, a <code>short</code> can be returned when the return type is declared as an <code>int</code>. And (assuming <code>Horse</code> extends <code>Animal</code>), a <code>Horse</code> reference can be returned when the return type is declared an <code>Animal</code>.</p>
<p class="indent">We covered constructors in detail, learning that if you don’t provide a constructor for your class, the compiler will insert one. The compiler-generated constructor is called the default constructor, and it is always a no-arg constructor with a no-arg call to <code>super()</code>. The default constructor will never be generated if even a single constructor exists in your class (regardless of the arguments of that constructor); so if you need more than one constructor in your class and you want a no-arg constructor, you’ll have to write it yourself. We also saw that constructors are not inherited and that you can be confused by a method that has the same name as the class (which is legal). The return type is the giveaway that a method is not a constructor because constructors do not have return types.</p>
<p class="indent">We saw how all the constructors in an object’s inheritance tree will always be invoked when the object is instantiated using <code>new</code>. We also saw that constructors can be overloaded, which means defining constructors with different argument lists. A constructor can invoke another constructor of the same class using the keyword <code>this()</code>, as though the constructor were a method named <code>this()</code>. We saw that every constructor must have either <code>this()</code> or <code>super()</code> as the first statement (although the compiler can insert it for you).</p>
<p class="indent">After constructors, we did a quick introduction to design patterns, focusing on a common pattern, the singleton. You use the singleton pattern whenever you want to make sure that only one instance of a class can ever be created.</p>
<p class="indent">After singleton, we introduced immutable classes. The phrase “immutable class” is a bit misleading; you should think of these as thread-safe classes whose objects are made immutable through the generous use of the <code>private</code> and <code>final</code> keywords and by not providing any setter methods.</p>
<p class="indent">Next, we discussed the two kinds of initialization blocks and how and when their code runs.</p>
<p class="indent">We looked at <code>static</code> methods and variables. <code>static</code> members are tied to the class or interface, not an instance, so there is only one copy of any <code>static</code> member. A common mistake is to attempt to reference an instance variable from a <code>static</code> method. Use the respective class or interface name with the dot operator to access <code>static</code> members.</p>
<p class="indent">And, once again, you learned that the exam includes tricky questions designed largely to test your ability to recognize just how tricky the questions can be.</p>
<h3 class="h3b" id="ch2lev1sec14"><span id="page_149" epub:type="pagebreak"></span><img src="images/tick1.jpg" alt="Images" /> TWO-MINUTE DRILL</h3>
<p class="noindent">Here are some of the key points from each certification objective in this chapter.</p>
<h5 class="h5">Encapsulation, IS-A, HAS-A* (OCP Objectives 1.1 and 1.2 )</h5>
<p class="bull-image"><img class="inline" src="images/box1.jpg" alt="Images" />  Encapsulation helps hide implementation behind an interface (or API).</p>
<p class="bull-image"><img class="inline" src="images/box1.jpg" alt="Images" />  Encapsulated code has two features:</p>
<p class="bull-image1"><img class="inline" src="images/box1.jpg" alt="Images" />  Instance variables are kept protected (usually with the <code>private</code> modifier).</p>
<p class="bull-image1"><img class="inline" src="images/box1.jpg" alt="Images" />  Getter and setter methods provide access to instance variables.</p>
<p class="bull-image"><img class="inline" src="images/box1.jpg" alt="Images" />  IS-A refers to inheritance or implementation.</p>
<p class="bull-image"><img class="inline" src="images/box1.jpg" alt="Images" />  IS-A is expressed with the keyword <code>extends</code> or <code>implements</code>.</p>
<p class="bull-image"><img class="inline" src="images/box1.jpg" alt="Images" />  IS-A, “inherits from,” and “is a subtype of” are all equivalent expressions.</p>
<p class="bull-image"><img class="inline" src="images/box1.jpg" alt="Images" />  HAS-A means an instance of one class “has a” reference to an instance of another class or another instance of the same class. *HAS-A is NOT on the exam, but it’s good to know.</p>
<h5 class="h5">Inheritance (OCP Objective 1.2)</h5>
<p class="bull-image"><img class="inline" src="images/box1.jpg" alt="Images" />  Inheritance allows a type to be a subtype of a supertype and thereby inherit <code>public</code> and <code>protected</code> variables and methods of the supertype.</p>
<p class="bull-image"><img class="inline" src="images/box1.jpg" alt="Images" />  Inheritance is a key concept that underlies IS-A, polymorphism, overriding, overloading, and casting.</p>
<p class="bull-image"><img class="inline" src="images/box1.jpg" alt="Images" />  All classes (except class <code>Object</code>) are subclasses of type <code>Object</code>, and therefore they inherit <code>Object</code>’s methods.</p>
<h5 class="h5">Polymorphism (OCP Objective 1.3)</h5>
<p class="bull-image"><img class="inline" src="images/box1.jpg" alt="Images" />  Polymorphism means “many forms.“</p>
<p class="bull-image"><img class="inline" src="images/box1.jpg" alt="Images" />  A reference variable is always of a single, unchangeable type, but it can refer to a subtype object.</p>
<p class="bull-image"><img class="inline" src="images/box1.jpg" alt="Images" />  A single object can be referred to by reference variables of many different types—as long as they are the same type or a supertype of the object.</p>
<p class="bull-image"><span id="page_150" epub:type="pagebreak"></span><img class="inline" src="images/box1.jpg" alt="Images" />  The reference variable’s type (not the object’s type) determines which methods can be called!</p>
<p class="bull-image"><img class="inline" src="images/box1.jpg" alt="Images" />  Polymorphic method invocations apply only to overridden <em>instance</em> methods.</p>
<h5 class="h5">Overriding and Overloading (OCP Objectives 1.2 and 1.3)</h5>
<p class="bull-image"><img class="inline" src="images/box1.jpg" alt="Images" />  Methods can be overridden or overloaded; constructors can be overloaded but not overridden.</p>
<p class="bull-image"><img class="inline" src="images/box1.jpg" alt="Images" />  With respect to the method it overrides, the overriding method</p>
<p class="bull-image1"><img class="inline" src="images/box1.jpg" alt="Images" />  Must have the same argument list</p>
<p class="bull-image1"><img class="inline" src="images/box1.jpg" alt="Images" />  Must have the same return type or a subclass (known as a covariant return)</p>
<p class="bull-image1"><img class="inline" src="images/box1.jpg" alt="Images" />  Must not have a more restrictive access modifier</p>
<p class="bull-image1"><img class="inline" src="images/box1.jpg" alt="Images" />  May have a less restrictive access modifier</p>
<p class="bull-image1"><img class="inline" src="images/box1.jpg" alt="Images" />  Must not throw new or broader checked exceptions</p>
<p class="bull-image1"><img class="inline" src="images/box1.jpg" alt="Images" />  May throw fewer or narrower checked exceptions, or any unchecked exception</p>
<p class="bull-image"><img class="inline" src="images/box1.jpg" alt="Images" />  <code>f</code><code>inal</code> methods cannot be overridden.</p>
<p class="bull-image"><img class="inline" src="images/box1.jpg" alt="Images" />  Only inherited methods may be overridden, and remember that private methods are not inherited.</p>
<p class="bull-image"><img class="inline" src="images/box1.jpg" alt="Images" />  A subclass uses <code>super.overriddenMethodName()</code> to call the superclass version of an overridden method.</p>
<p class="bull-image"><img class="inline" src="images/box1.jpg" alt="Images" />  A subclass uses <code>MyInterface.super.overriddenMethodName()</code> to call the super interface version on an overridden method.</p>
<p class="bull-image"><img class="inline" src="images/box1.jpg" alt="Images" />  Overloading means reusing a method name but with different arguments.</p>
<p class="bull-image"><img class="inline" src="images/box1.jpg" alt="Images" />  Overloaded methods</p>
<p class="bull-image1"><img class="inline" src="images/box1.jpg" alt="Images" />  Must have different argument lists</p>
<p class="bull-image1"><img class="inline" src="images/box1.jpg" alt="Images" />  May have different return types, if argument lists are also different</p>
<p class="bull-image1"><img class="inline" src="images/box1.jpg" alt="Images" />  May have different access modifiers</p>
<p class="bull-image1"><img class="inline" src="images/box1.jpg" alt="Images" />  May throw different exceptions</p>
<p class="bull-image"><img class="inline" src="images/box1.jpg" alt="Images" />  Methods from a supertype can be overloaded in a subtype.</p>
<p class="bull-image"><img class="inline" src="images/box1.jpg" alt="Images" />  Polymorphism applies to overriding, not to overloading.</p>
<p class="bull-image"><img class="inline" src="images/box1.jpg" alt="Images" />  Object type (not the reference variable’s type) determines which overridden method is used at runtime.</p>
<p class="bull-image"><img class="inline" src="images/box1.jpg" alt="Images" />  Reference type determines which overloaded method will be used at compile time.</p>
<h5 class="h5"><span id="page_151" epub:type="pagebreak"></span>@Override Annotation (OCP Objective 2.5)</h5>
<p class="bull-image"><img class="inline" src="images/box1.jpg" alt="Images" />  The @Override annotation can be used to ask the compiler to verify that you’ve properly overridden a method.</p>
<p class="bull-image"><img class="inline" src="images/box1.jpg" alt="Images" />  The @Override annotation can be used to ask the compiler to verify that you’ve properly implemented an interface method.</p>
<h5 class="h5">Reference Variable Casting (OCP Objectives 1.2 and 1.3)</h5>
<p class="bull-image"><img class="inline" src="images/box1.jpg" alt="Images" />  There are two types of reference variable casting: downcasting and upcasting.</p>
<p class="bull-image1"><img class="inline" src="images/box1.jpg" alt="Images" />  <strong>D</strong><strong>owncasting</strong> If you have a reference variable that refers to a subtype object, you can assign it to a reference variable of the subtype. You must make an explicit cast to do this, and the result is that you can access the subtype’s members with this new reference variable.</p>
<p class="bull-image1"><img class="inline" src="images/box1.jpg" alt="Images" />  <strong>U</strong><strong>pcasting</strong> You can assign a reference variable to a supertype reference variable explicitly or implicitly. This is an inherently safe operation because the assignment restricts the access capabilities of the new variable.</p>
<h5 class="h5">Implementing an Interface (OCP Objective 2.5)</h5>
<p class="bull-image"><img class="inline" src="images/box1.jpg" alt="Images" />  When you implement an interface, you are fulfilling its contract.</p>
<p class="bull-image"><img class="inline" src="images/box1.jpg" alt="Images" />  You implement an interface by properly and concretely implementing all the abstract methods defined by the interface.</p>
<p class="bull-image"><img class="inline" src="images/box1.jpg" alt="Images" />  A single class can implement many interfaces.</p>
<h5 class="h5">Return Types (OCP Objectives 1.2 and 1.3)</h5>
<p class="bull-image"><img class="inline" src="images/box1.jpg" alt="Images" />  Overloaded methods can change return types; overridden methods cannot, except in the case of covariant returns.</p>
<p class="bull-image"><img class="inline" src="images/box1.jpg" alt="Images" />  Object reference return types can accept <code>null</code> as a return value.</p>
<p class="bull-image"><img class="inline" src="images/box1.jpg" alt="Images" />  An array is a legal return type, both to declare and return as a value.</p>
<p class="bull-image"><img class="inline" src="images/box1.jpg" alt="Images" />  For methods with primitive return types, any value that can be implicitly converted to the return type can be returned.</p>
<p class="bull-image"><img class="inline" src="images/box1.jpg" alt="Images" />  Nothing can be returned from a <code>void</code>, but you can return nothing. You’re allowed to simply say <code>return</code> in any method with a <code>void</code> return type to bust out of a method early. But you can’t return nothing from a method with a non-<code>void</code> return type.</p>
<p class="bull-image"><span id="page_152" epub:type="pagebreak"></span><img class="inline" src="images/box1.jpg" alt="Images" />  Methods with an object reference return type can return a subtype.</p>
<p class="bull-image"><img class="inline" src="images/box1.jpg" alt="Images" />  Methods with an interface return type can return any implementer.</p>
<h5 class="h5">Constructors and Instantiation (OCP Objectives 1.2 and 1.3)</h5>
<p class="bull-image"><img class="inline" src="images/box1.jpg" alt="Images" />  A constructor is always invoked when a new object is created.</p>
<p class="bull-image"><img class="inline" src="images/box1.jpg" alt="Images" />  When a new object is created, a constructor for each superclass in the object’s inheritance tree will be invoked.</p>
<p class="bull-image"><img class="inline" src="images/box1.jpg" alt="Images" />  Every class, even an abstract class, has at least one constructor.</p>
<p class="bull-image"><img class="inline" src="images/box1.jpg" alt="Images" />  Constructors must have the same name as the class.</p>
<p class="bull-image"><img class="inline" src="images/box1.jpg" alt="Images" />  Constructors don’t have a return type. If you see code with a return type, it’s a method with the same name as the class; it’s not a constructor.</p>
<p class="bull-image"><img class="inline" src="images/box1.jpg" alt="Images" />  Typical constructor execution occurs as follows:</p>
<p class="bull-image1"><img class="inline" src="images/box1.jpg" alt="Images" />  The constructor calls its superclass constructor, which calls its superclass constructor, and so on, all the way up to the <code>Object</code> constructor.</p>
<p class="bull-image1"><img class="inline" src="images/box1.jpg" alt="Images" />  The <code>Object</code> constructor executes and then returns to the calling constructor, which runs to completion and then returns to its calling constructor, and so on, back down to the completion of the constructor of the actual instance being created.</p>
<p class="bull-image"><img class="inline" src="images/box1.jpg" alt="Images" />  Constructors can use any access modifier (even <code>private</code>!).</p>
<p class="bull-image"><img class="inline" src="images/box1.jpg" alt="Images" />  The compiler will create a default constructor if you don’t create any constructors in your class.</p>
<p class="bull-image"><img class="inline" src="images/box1.jpg" alt="Images" />  The default constructor is a no-arg constructor with a no-arg call to <code>super()</code>.</p>
<p class="bull-image"><img class="inline" src="images/box1.jpg" alt="Images" />  The first statement of every constructor must be a call either to <code>this()</code> (an overloaded constructor) or to <code>super()</code>.</p>
<p class="bull-image"><img class="inline" src="images/box1.jpg" alt="Images" />  The compiler will add a call to <code>super()</code> unless you have already put in a call to <code>this()</code> or <code>super()</code>.</p>
<p class="bull-image"><img class="inline" src="images/box1.jpg" alt="Images" />  Instance members are accessible only after the <code>super</code> constructor runs.</p>
<p class="bull-image"><img class="inline" src="images/box1.jpg" alt="Images" />  <code>A</code><code>bstract</code> classes have constructors that are called when a concrete subclass is instantiated.</p>
<p class="bull-image"><img class="inline" src="images/box1.jpg" alt="Images" />  Interfaces do not have constructors.</p>
<p class="bull-image"><span id="page_153" epub:type="pagebreak"></span><img class="inline" src="images/box1.jpg" alt="Images" />  If your superclass does not have a no-arg constructor, you must create a constructor and insert a call to <code>super()</code> with arguments matching those of the superclass constructor.</p>
<p class="bull-image"><img class="inline" src="images/box1.jpg" alt="Images" />  Constructors are never inherited; thus, they cannot be overridden.</p>
<p class="bull-image"><img class="inline" src="images/box1.jpg" alt="Images" />  A constructor can be directly invoked only by another constructor (using a call to <code>super()</code> or <code>this()</code>).</p>
<p class="bull-image"><img class="inline" src="images/box1.jpg" alt="Images" />  Regarding issues with calls to <code>this()</code>:</p>
<p class="bull-image1"><img class="inline" src="images/box1.jpg" alt="Images" />  They may appear only as the first statement in a constructor.</p>
<p class="bull-image1"><img class="inline" src="images/box1.jpg" alt="Images" />  The argument list determines which overloaded constructor is called.</p>
<p class="bull-image1"><img class="inline" src="images/box1.jpg" alt="Images" />  Constructors can call constructors, and so on, but sooner or later one of them better call <code>super()</code> or the stack will explode.</p>
<p class="bull-image1"><img class="inline" src="images/box1.jpg" alt="Images" />  Calls to <code>this()</code> and <code>super()</code> cannot be in the same constructor. You can have one or the other, but never both.</p>
<h5 class="h5">Singleton Design Pattern (OCP Objective 1.5)</h5>
<p class="bull-image"><img class="inline" src="images/box1.jpg" alt="Images" />  A design pattern is “a general reusable solution to a commonly occurring problem within a given context.“</p>
<p class="bull-image"><img class="inline" src="images/box1.jpg" alt="Images" />  Having only one instance of the object allows a program to share its state.</p>
<p class="bull-image"><img class="inline" src="images/box1.jpg" alt="Images" />  This pattern might improve performance by not repeating the same work.</p>
<p class="bull-image"><img class="inline" src="images/box1.jpg" alt="Images" />  This pattern often stores a single instance as a static variable.</p>
<p class="bull-image"><img class="inline" src="images/box1.jpg" alt="Images" />  We can instantiate right away (eager) or when needed (lazy).</p>
<h5 class="h5">Immutable Classes (OCP Objective 1.5)</h5>
<p class="bull-image"><img class="inline" src="images/box1.jpg" alt="Images" />  Since they are thread-safe, they are great for concurrent and/or parallel applications.</p>
<p class="bull-image"><img class="inline" src="images/box1.jpg" alt="Images" />  They should be built using the following guidelines:</p>
<p class="bull-image1"><img class="inline" src="images/box1.jpg" alt="Images" />  Mark the class final</p>
<p class="bull-image1"><img class="inline" src="images/box1.jpg" alt="Images" />  Mark the variables private and final</p>
<p class="bull-image1"><img class="inline" src="images/box1.jpg" alt="Images" />  Do NOT provide setter methods</p>
<p class="bull-image1"><img class="inline" src="images/box1.jpg" alt="Images" />  Whenever references to mutable types are sent or received, a defensive copy should be used.</p>
<p class="bull-image"><img class="inline" src="images/box1.jpg" alt="Images" />  Unlike singletons, many instances of an immutable class can be made.</p>
<h5 class="h5"><span id="page_154" epub:type="pagebreak"></span>Initialization Blocks (OCP Objective 1.6)</h5>
<p class="bull-image"><img class="inline" src="images/box1.jpg" alt="Images" />  Use <code>static init</code> blocks—<code>static { /* code here */ }</code>—for code you want to have run once, when the class is first loaded. Multiple blocks run from the top down.</p>
<p class="bull-image"><img class="inline" src="images/box1.jpg" alt="Images" />  Use normal <code>init</code> blocks—<code>{ /* code here }</code>—for code you want to have run for every new instance, right after all the super constructors have run. Again, multiple blocks run from the top of the class down.</p>
<h5 class="h5">Statics (OCP Objective 1.6)</h5>
<p class="bull-image"><img class="inline" src="images/box1.jpg" alt="Images" />  Use <code>static</code> methods to implement behaviors that are not affected by the state of any instances.</p>
<p class="bull-image"><img class="inline" src="images/box1.jpg" alt="Images" />  Use <code>static</code> variables to hold data that is class specific as opposed to instance specific—there will be only one copy of a <code>static</code> variable.</p>
<p class="bull-image"><img class="inline" src="images/box1.jpg" alt="Images" />  All <code>static</code> members belong to the class, not to any instance.</p>
<p class="bull-image"><img class="inline" src="images/box1.jpg" alt="Images" />  A <code>static</code> method can’t access an instance variable directly.</p>
<p class="bull-image"><img class="inline" src="images/box1.jpg" alt="Images" />  Use the dot operator to access <code>static</code> members, but remember that using a reference variable with the dot operator is really a syntax trick, and the compiler will substitute the class name for the reference variable; for instance:</p>
<p class="bull-image1"><code>d.doStuff();</code></p>
<p class="bull-image1">becomes</p>
<p class="bull-image1"><code>Dog.doStuff();</code></p>
<p class="bull-image"><img class="inline" src="images/box1.jpg" alt="Images" />  To invoke an interface’s static method, use <code>MyInterface.doStuff()</code> syntax.</p>
<p class="bull-image"><img class="inline" src="images/box1.jpg" alt="Images" />  <code>s</code><code>tatic</code> methods can’t be overridden, but they can be redefined.</p>
<h3 class="h3b" id="ch2lev1sec15"><span id="page_155" epub:type="pagebreak"></span><img src="images/qs.jpg" alt="Images" /> SELF TEST</h3>
<p class="que"><strong><a id="ch2ans1" href="ch2.xhtml#r_ch2ans1">1</a>.</strong>   Given:</p>
<p class="alpha-no1"><code>public abstract interface Frobnicate { public void twiddle(String s); }</code></p>
<p class="alpha-no">Which is a correct class? (Choose all that apply.)</p>
<p class="alpha"><img src="images/f0155-01.jpg" alt="Images" /></p>
<p class="que"><strong><a id="ch2ans2" href="ch2.xhtml#r_ch2ans2">2</a>.</strong>   Given:</p>
<p class="alpha"><img src="images/un155-07.jpg" alt="Images" /></p>
<p class="alpha-no">What is the result?</p>
<p class="alpha">A. <code>BD</code></p>
<p class="alpha">B. <code>DB</code></p>
<p class="alpha">C. <code>BDC</code></p>
<p class="alpha">D. <code>DBC</code></p>
<p class="alpha">E. Compilation fails</p>
<p class="que"><span id="page_156" epub:type="pagebreak"></span><strong><a id="ch2ans3" href="ch2.xhtml#r_ch2ans3">3</a>.</strong>   Given:</p>
<p class="alpha"><img src="images/un156-01.jpg" alt="Images" /></p>
<p class="alpha-no">What is the result?</p>
<p class="alpha">A. <code>Clidlet</code></p>
<p class="alpha">B. <code>Clidder</code></p>
<p class="alpha">C. <code>Clidder<br/>Clidlet</code></p>
<p class="alpha">D. <code>Clidlet<br/>Clidder</code></p>
<p class="alpha">E. Compilation fails</p>
<p class="alpha-no2"><strong> Special Note:</strong> The next question crudely simulates a “drag-and-drop” style of question that you probably will NOT encounter on the exam, but just in case, we’ve left a few drag-and-drop questions in the book.</p>
<p class="que"><strong><a id="ch2ans4" href="ch2.xhtml#r_ch2ans4">4</a>.</strong>   Using the <strong>fragments</strong> below, complete the following <strong>code</strong> so it compiles. Note that you may not have to fill in all of the slots.</p>
<p class="alpha-no">Code:</p>
<p class="alpha-no"><img src="images/un156-02.jpg" alt="Images" /></p>
<p class="alpha-no"><strong>Fragments:</strong> Use the following fragments zero or more times:</p>
<p class="alpha-no"><img src="images/un156-03.jpg" alt="Images" /></p>
<p class="que"><span id="page_157" epub:type="pagebreak"></span><strong><a id="ch2ans5" href="ch2.xhtml#r_ch2ans5">5</a>.</strong>   Given:</p>
<p class="alpha-no"><img src="images/un157-01.jpg" alt="Images" /></p>
<p class="alpha-no">What is the result?</p>
<p class="alpha">A. <code>pre b1 b2 r3 r2 hawk</code></p>
<p class="alpha">B. <code>pre b2 b1 r2 r3 hawk</code></p>
<p class="alpha">C. <code>pre b2 b1 r2 r3 hawk r1 r4</code></p>
<p class="alpha">D. <code>r1 r4 pre b1 b2 r3 r2 hawk</code></p>
<p class="alpha">E. <code>r1 r4 pre b2 b1 r2 r3 hawk</code></p>
<p class="alpha">F. <code>pre r1 r4 b1 b2 r3 r2 hawk</code></p>
<p class="alpha">G. <code>pre r1 r4 b2 b1 r2 r3 hawk</code></p>
<p class="alpha">H. The order of output cannot be predicted</p>
<p class="alpha">I. Compilation fails</p>
<p class="alpha-no">Note: You’ll probably never see this many choices on the real exam!</p>
<p class="que"><strong><a id="ch2ans6" href="ch2.xhtml#r_ch2ans6">6</a>.</strong>   Given the following:</p>
<p class="alpha-no2"><img src="images/un157-02.jpg" alt="Images" /></p>
<p class="alpha-no"><span id="page_158" epub:type="pagebreak"></span><img src="images/un158-01.jpg" alt="Images" /></p>
<p class="alpha-not">Which of the following, inserted at line 9, will compile? (Choose all that apply.)</p>
<p class="alpha">A. <code>x2.do2();</code></p>
<p class="alpha">B. <code>(Y)x2.do2();</code></p>
<p class="alpha">C. <code>((Y)x2).do2();</code></p>
<p class="alpha">D. None of the above statements will compile</p>
<p class="que"><strong><a id="ch2ans7" href="ch2.xhtml#r_ch2ans7">7</a>.</strong>   Given:</p>
<p class="alpha-no"><img src="images/un158-03.jpg" alt="Images" /></p>
<p class="alpha-no">What is the result? (Choose all that apply.)</p>
<p class="alpha">A. <code>2</code> will be included in the output</p>
<p class="alpha">B. <code>3</code> will be included in the output</p>
<p class="alpha">C. <code>hi</code> will be included in the output</p>
<p class="alpha">D. Compilation fails</p>
<p class="alpha">E. An exception is thrown at runtime</p>
<p class="que"><strong><a id="ch2ans8" href="ch2.xhtml#r_ch2ans8">8</a>.</strong>   Given:</p>
<p class="alpha-no2"><img src="images/un158-04.jpg" alt="Images" /></p>
<p class="alpha-no2"><span id="page_159" epub:type="pagebreak"></span><img src="images/un159-01.jpg" alt="Images" /></p>
<p class="alpha-no">What is the result? (Choose all that apply.)</p>
<p class="alpha">A. <code>howl howl sniff</code></p>
<p class="alpha">B. <code>howl woof sniff</code></p>
<p class="alpha">C. <code>howl howl</code> followed by an exception</p>
<p class="alpha">D. <code>howl woof</code> followed by an exception</p>
<p class="alpha">E. Compilation fails with an error at line 14</p>
<p class="alpha">F. Compilation fails with an error at line 15</p>
<p class="que"><strong><a id="ch2ans9" href="ch2.xhtml#r_ch2ans9">9</a>.</strong>   Given:</p>
<p class="alpha-no2"><img src="images/un159-02.jpg" alt="Images" /></p>
<p class="alpha-no">What is the result? (Choose all that apply.)</p>
<p class="alpha">A. An exception is thrown at runtime</p>
<p class="alpha">B. The code compiles and runs with no output</p>
<p class="alpha">C. Compilation fails with an error at line 8</p>
<p class="alpha">D. Compilation fails with an error at line 9</p>
<p class="alpha">E. Compilation fails with an error at line 12</p>
<p class="alpha">F. Compilation fails with an error at line 13</p>
<p class="que1"><strong><a id="ch2ans10" href="ch2.xhtml#r_ch2ans10">10</a>.</strong>   Given:</p>
<p class="alpha-no2"><img src="images/un159-03.jpg" alt="Images" /></p>
<p class="alpha-no"><span id="page_160" epub:type="pagebreak"></span><img src="images/un160-01.jpg" alt="Images" /></p>
<p class="alpha-no">What is the result?</p>
<p class="alpha">A. <code>fa fa</code></p>
<p class="alpha">B. <code>fa la</code></p>
<p class="alpha">C. <code>la la</code></p>
<p class="alpha">D. Compilation fails</p>
<p class="alpha">E. An exception is thrown at runtime</p>
<p class="que1"><strong><a id="ch2ans11" href="ch2.xhtml#r_ch2ans11">11</a>.</strong>   Given:</p>
<p class="alpha-no2"><img src="images/un160-02.jpg" alt="Images" /></p>
<p class="alpha-no">What is the result?</p>
<p class="alpha">A. <code>subsub</code></p>
<p class="alpha">B. <code>sub subsub</code></p>
<p class="alpha">C. <code>alpha subsub</code></p>
<p class="alpha">D. <code>alpha sub subsub</code></p>
<p class="alpha">E. Compilation fails</p>
<p class="alpha">F. An exception is thrown at runtime</p>
<p class="que1"><strong><a id="ch2ans12" href="ch2.xhtml#r_ch2ans12">12</a>.</strong>   Given:</p>
<p class="alpha-no2"><img src="images/un160-03.jpg" alt="Images" /></p>
<p class="alpha-no2"><span id="page_161" epub:type="pagebreak"></span><img src="images/un161-01.jpg" alt="Images" /></p>
<p class="alpha-no">What is the result?</p>
<p class="alpha">A. <code>h hn x</code></p>
<p class="alpha">B. <code>hn x h</code></p>
<p class="alpha">C. <code>b h hn x</code></p>
<p class="alpha">D. <code>b hn x h</code></p>
<p class="alpha">E. <code>bn x h hn x</code></p>
<p class="alpha">F. <code>b bn x h hn x</code></p>
<p class="alpha">G. <code>bn x b h hn x</code></p>
<p class="alpha">H. Compilation fails</p>
<p class="que1"><strong><a id="ch2ans13" href="ch2.xhtml#r_ch2ans13">13</a>.</strong>   Given:</p>
<p class="alpha-no2"><img src="images/un161-02.jpg" alt="Images" /></p>
<p class="alpha-no">What is the result?</p>
<p class="alpha">A. <code>furry bray</code></p>
<p class="alpha">B. <code>stripes bray</code></p>
<p class="alpha">C. <code>furry generic noise</code></p>
<p class="alpha">D. <code>stripes generic noise</code></p>
<p class="alpha">E. Compilation fails</p>
<p class="alpha">F. An exception is thrown at runtime</p>
<p class="que1"><strong><a id="ch2ans14" href="ch2.xhtml#r_ch2ans14">14</a>.</strong>   Given:</p>
<p class="alpha-no2"><img src="images/un161-03.jpg" alt="Images" /></p>
<p class="alpha-no"><span id="page_162" epub:type="pagebreak"></span><img src="images/un162-01.jpg" alt="Images" /></p>
<p class="alpha-no">What is the result? (Choose all that apply.)</p>
<p class="alpha">A. <code>hopping 212</code></p>
<p class="alpha">B. Compilation fails due to an error on line 2</p>
<p class="alpha">C. Compilation fails due to an error on line 5</p>
<p class="alpha">D. Compilation fails due to an error on line 12</p>
<p class="alpha">E. Compilation fails due to an error on line 13</p>
<p class="alpha">F. Compilation fails due to an error on line 14</p>
<p class="alpha">G. Compilation fails due to an error on line 16</p>
<p class="que1"><strong><a id="ch2ans15" href="ch2.xhtml#r_ch2ans15">15</a>.</strong>   Given:</p>
<p class="alpha-no2"><img src="images/un162-02.jpg" alt="Images" /></p>
<p class="alpha-no">What is the result?</p>
<p class="alpha">A. <code>1</code></p>
<p class="alpha">B. <code>2</code></p>
<p class="alpha">C. <code>3</code></p>
<p class="alpha">D. The output is unpredictable</p>
<p class="alpha"><span id="page_163" epub:type="pagebreak"></span>E. Compilation fails</p>
<p class="alpha">F. An exception is thrown at runtime</p>
<p class="que1"><strong><a id="ch2ans16" href="ch2.xhtml#r_ch2ans16">16</a>.</strong>   Given:</p>
<p class="alpha-no2"><img src="images/un163-01.jpg" alt="Images" /></p>
<p class="alpha-no">Which line(s) of code, inserted independently at // INSERT CODE HERE, will allow the code to compile? (Choose all that apply.)</p>
<p class="alpha"><img src="images/un163-02.jpg" alt="Images" /></p>
<p class="alpha">F. None of the lines, A–E, will allow the code to compile</p>
<p class="que1"><strong><a id="ch2ans17" href="ch2.xhtml#r_ch2ans17">17</a>.</strong>   Given:</p>
<p class="alpha-no2"><img src="images/un163-03.jpg" alt="Images" /></p>
<p class="alpha-no2"><span id="page_164" epub:type="pagebreak"></span><img src="images/un164-01.jpg" alt="Images" /></p>
<p class="alpha-no">What is the result? (Choose all that apply.)</p>
<p class="alpha">A. <code>Stuff stuff</code></p>
<p class="alpha">B. <code>doStuff stuff</code></p>
<p class="alpha">C. <code>doStuff my stuff</code></p>
<p class="alpha">D. An exception is thrown at runtime</p>
<p class="alpha">E. Compilation fails due to an <code>@Override</code>-related error</p>
<p class="alpha">F. Compilation fails due to an error other than an <code>@Override</code>-related error</p>
<p class="que1"><strong><a id="ch2ans18" href="ch2.xhtml#r_ch2ans18">18</a>.</strong>   Which statements about singletons are true? (Choose all that apply.)</p>
<p class="alpha">A. The singleton pattern ensures that no two objects of the same class will have duplicate state.</p>
<p class="alpha">B. A class that properly implements a singleton must have a constructor marked either private or protected.</p>
<p class="alpha">C. Typically, a singleton’s public-facing API has only one method.</p>
<p class="alpha">D. The singleton pattern is considered a creational design pattern.</p>
<p class="alpha">E. A properly designed singleton must declare at least one enum.</p>
<p class="que1"><strong><a id="ch2ans19" href="ch2.xhtml#r_ch2ans19">19</a>.</strong>   Which statements about immutable classes are true? (Choose all that apply.)</p>
<p class="alpha">A. They should be marked <code>final</code> so that they cannot be subclassed.</p>
<p class="alpha">B. Their fields should allow updates only via setter methods.</p>
<p class="alpha">C. Their objects must be instantiated via factory methods.</p>
<p class="alpha">D. None of their fields can be of mutable types.</p>
<p class="alpha">E. Reference variables sent in as instantiation arguments must be dealt with defensively.</p>
<p class="alpha">F. Reference variables returned in getters must be dealt with defensively.</p>
<p class="alpha">G. Properly designed immutable classes are well encapsulated.</p>
<h3 class="h3b" id="ch2lev2sec18"><span id="page_165" epub:type="pagebreak"></span><img src="images/aself.jpg" alt="Images" /> SELF TEST ANSWERS</h3>
<p class="que-q"><strong><a href="ch2.xhtml#ch2ans1" id="r_ch2ans1">1</a>.</strong>   <img src="images/tick2.jpg" alt="Images" />   <strong>B</strong> and <strong>E</strong> are correct. <strong>B</strong> is correct because an <code>abstract</code> class need not implement any or all of an interface’s methods. <strong>E</strong> is correct because the class implements the interface method and additionally overloads the <code>twiddle()</code> method.</p>
<p class="quep"><img src="images/times.jpg" alt="Images" />   <strong>A, C,</strong> and<strong> D</strong> are incorrect. <strong>A</strong> is incorrect because <code>abstract</code> methods have no body. <strong>C</strong> is incorrect because classes implement interfaces; they don’t extend them. <strong>D</strong> is incorrect because overloading a method is not implementing it. (OCP Objectives 1.2, 1.3, and 2.5)</p>
<p class="que-q"><strong><a href="ch2.xhtml#ch2ans2" id="r_ch2ans2">2</a>.</strong>   <img src="images/tick2.jpg" alt="Images" />   <strong>E</strong> is correct. The implied <code>super()</code> call in <code>Bottom2</code>’s constructor cannot be satisfied because there is no no-arg constructor in <code>Top</code>. A default no-arg constructor is generated by the compiler only if the class has no constructor defined explicitly.</p>
<p class="quep"><img src="images/times.jpg" alt="Images" />   <strong>A, B, C,</strong> and <strong>D</strong> are incorrect based on the above. (OCP Objectives 1.2 and 1.3)</p>
<p class="que-q"><strong><a href="ch2.xhtml#ch2ans3" id="r_ch2ans3">3</a>.</strong>   <img src="images/tick2.jpg" alt="Images" />   <strong>A</strong> is correct. Although a <code>final</code> method cannot be overridden, in this case, the method is private and, therefore, hidden. The effect is that a new, accessible method flipper is created. Therefore, no polymorphism occurs in this example; the method invoked is simply that of the child class; and no error occurs.</p>
<p class="quep"><img src="images/times.jpg" alt="Images" />   <strong>B, C, D,</strong> and <strong>E</strong> are incorrect based on the preceding. (OCP Objectives 1.3 and 2.2)</p>
<p class="alpha-no"><strong>Special Note:</strong> This next question crudely simulates a style of question known as “drag-and-drop.” Up through the SCJP 6 exam, drag-and-drop questions were included. As of early 2018, Oracle DOES NOT include any drag-and-drop questions on its Java exams, but just in case Oracle’s policy changes, we left a few in the book.</p>
<p class="que-q"><strong><a href="ch2.xhtml#ch2ans4" id="r_ch2ans4">4</a>.</strong>   Here is the answer:</p>
<p class="alpha-no2"><img src="images/un165-01.jpg" alt="Images" /></p>
<p class="alpha-no">As there is no droppable tile for the variable <code>x</code> and the parentheses (in the <code>Kinder</code> constructor) are already in place and empty, there is no way to construct a call to the superclass constructor that takes an argument. Therefore, the only remaining possibility is to create a call to the no-arg superclass constructor. This is done as <code>super();</code>. The line cannot be left blank, as the parentheses are already in place. Further, since the superclass constructor called is the no-arg version, this constructor must be created. It will not be created by the compiler because another constructor is already present. (OCP Objectives 1.2 and 1.3)</p>
<p class="que-q"><span id="page_166" epub:type="pagebreak"></span><strong><a href="ch2.xhtml#ch2ans5" id="r_ch2ans5">5</a>.</strong>   <img src="images/tick2.jpg" alt="Images" />   <strong>D</strong> is correct. Static <code>init</code> blocks are executed at class loading time; instance <code>init</code> blocks run right after the call to <code>super()</code> in a constructor. When multiple <code>init</code> blocks of a single type occur in a class, they run in order, from the top down.</p>
<p class="quep"><img src="images/times.jpg" alt="Images" />   <strong>A, B, C, E, F, G, H,</strong> and <strong>I</strong> are incorrect based on the above. Note: You’ll probably never see this many choices on the real exam! (OCP Objective 2.6)</p>
<p class="que-q"><strong><a href="ch2.xhtml#ch2ans6" id="r_ch2ans6">6</a>.</strong>   <img src="images/tick2.jpg" alt="Images" />   <strong>C</strong> is correct. Before you can invoke <code>Y</code>’s <code>do2</code> method, you have to cast <code>x2</code> to be of type <code>Y</code>.</p>
<p class="quep"><img src="images/times.jpg" alt="Images" />   <strong>A, B,</strong> and <strong>D</strong> are incorrect based on the preceding. <strong>B</strong> looks like a proper cast, but without the second set of parentheses, the compiler thinks it’s an incomplete statement. (OCP Objectives 1.2 and 1.3)</p>
<p class="que-q"><strong><a href="ch2.xhtml#ch2ans7" id="r_ch2ans7">7</a>.</strong>   <img src="images/tick2.jpg" alt="Images" />   <strong>A</strong> is correct. It’s legal to overload <code>main()</code>. Because no instances of <code>Locomotive</code> are created, the constructor does not run and the overloaded version of <code>main()</code> does not run.</p>
<p class="quep"><img src="images/times.jpg" alt="Images" />   <strong>B, C, D,</strong> and <strong>E</strong> are incorrect based on the preceding. (OCP Objectives 1.2 and 1.3)</p>
<p class="que-q"><strong><a href="ch2.xhtml#ch2ans8" id="r_ch2ans8">8</a>.</strong>   <img src="images/tick2.jpg" alt="Images" />   <strong>F</strong> is correct. Class <code>Dog</code> doesn’t have a <code>sniff</code> method.</p>
<p class="quep"><img src="images/times.jpg" alt="Images" />   <strong>A, B, C, D,</strong> and <strong>E</strong> are incorrect based on the above information. (OCP Objectives 1.2 and 1.3)</p>
<p class="que-q"><strong><a href="ch2.xhtml#ch2ans9" id="r_ch2ans9">9</a>.</strong>   <img src="images/tick2.jpg" alt="Images" />   <strong>A</strong> is correct. A <code>ClassCastException</code> will be thrown when the code attempts to downcast a <code>Tree</code> to a <code>Redwood</code>.</p>
<p class="quep"><img src="images/times.jpg" alt="Images" />   <strong>B, C, D, E,</strong> and <strong>F</strong> are incorrect based on the above information. (OCP Objectives 1.2 and 1.3)</p>
<p class="que-q1"><strong><a href="ch2.xhtml#ch2ans10" id="r_ch2ans10">10</a>.</strong>   <img src="images/tick2.jpg" alt="Images" />   <strong>B</strong> is correct. The code is correct, but polymorphism doesn’t apply to <code>static</code> methods.</p>
<p class="quep"><img src="images/times.jpg" alt="Images" />   <strong>A, C, D,</strong> and<strong> E</strong> are incorrect based on the above information. (OCP Objectives 1.3 and 1.6)</p>
<p class="que-q1"><strong><a href="ch2.xhtml#ch2ans11" id="r_ch2ans11">11</a>.</strong>   <img src="images/tick2.jpg" alt="Images" />   <strong>C</strong> is correct. Watch out, because <code>SubSubAlpha</code> extends <code>Alpha</code>! Because the code doesn’t attempt to make a <code>SubAlpha</code>, the private constructor in <code>SubAlpha</code> is okay.</p>
<p class="quep"><img src="images/times.jpg" alt="Images" />   <strong>A, B, D, E,</strong> and <strong>F</strong> are incorrect based on the above information. (OCP Objectives 1.2 and 1.3)</p>
<p class="que-q1"><strong><a href="ch2.xhtml#ch2ans12" id="r_ch2ans12">12</a>.</strong>   <img src="images/tick2.jpg" alt="Images" />   <strong>C</strong> is correct. Remember that constructors call their superclass constructors, which execute first, and that constructors can be overloaded.</p>
<p class="quep"><img src="images/times.jpg" alt="Images" />   <strong>A, B, D, E, F, G,</strong> and <strong>H</strong> are incorrect based on the above information. (OCP Objectives 1.2 and 1.3)</p>
<p class="que-q1"><strong><a href="ch2.xhtml#ch2ans13" id="r_ch2ans13">13</a>.</strong>   <img src="images/tick2.jpg" alt="Images" />   <strong>A</strong> is correct. Polymorphism is only for instance methods, not instance variables.</p>
<p class="quep"><img src="images/times.jpg" alt="Images" />   <strong>B, C, D, E,</strong> and <strong>F</strong> are incorrect based on the above information. (OCP Objective 1.3)</p>
<p class="que-q1"><strong><a href="ch2.xhtml#ch2ans14" id="r_ch2ans14">14</a>.</strong>   <img src="images/tick2.jpg" alt="Images" />   <strong>E</strong> and <strong>G</strong> are correct. Neither of these lines of code uses the correct syntax to invoke an interface’s static method.</p>
<p class="quep"><img src="images/times.jpg" alt="Images" />   <strong>A, B, C, D,</strong> and <strong>F</strong> are incorrect based on the above information. (OCP Objective 2.5)</p>
<p class="que-q1"><span id="page_167" epub:type="pagebreak"></span><strong><a href="ch2.xhtml#ch2ans15" id="r_ch2ans15">15</a>.</strong>   <img src="images/tick2.jpg" alt="Images" />   <strong>E</strong> is correct. This is kind of a trick question; the implementing method must be marked <code>public</code>. If it was, all the other code is legal, and the output would be 3. If you understood all the multiple inheritance rules and just missed the access modifier, give yourself half credit.</p>
<p class="quep"><img src="images/times.jpg" alt="Images" />   <strong>A, B, C, D,</strong> and <strong>F</strong> are incorrect based on the above information. (OCP Objective 2.5)</p>
<p class="que-q1"><strong><a href="ch2.xhtml#ch2ans16" id="r_ch2ans16">16</a>.</strong>   <img src="images/tick2.jpg" alt="Images" />   <strong>A</strong> and <strong>C</strong> are correct. <strong>A</strong> uses correct syntax to invoke the class’s method, and <strong>C</strong> uses the correct syntax to invoke the interface’s overloaded <code>default</code> method.</p>
<p class="quep"><img src="images/times.jpg" alt="Images" />   <strong>B, D, E,</strong> and <strong>F</strong> are incorrect based on the above information. (OCP Objective 2.5)</p>
<p class="que-q1"><strong><a href="ch2.xhtml#ch2ans17" id="r_ch2ans17">17</a>.</strong>   <img src="images/tick2.jpg" alt="Images" />   <strong>F</strong> is correct. The <code>@Override</code> methods are properly overridden, but interface methods are public, so the compiler will complain about weaker access privileges. This question could be called a “misdirection” question. On the surface, it appears to be about <code>@Override</code>, but you might get bitten by another problem. We agree that these are tricky, but you will encounter this sort of tricky question on the real exam.</p>
<p class="quep"><img src="images/times.jpg" alt="Images" />   <strong>A, B, C, D,</strong> and <strong>E</strong> are incorrect based on the above information. (OCP Objective 2.5)</p>
<p class="que-q1"><strong><a href="ch2.xhtml#ch2ans18" id="r_ch2ans18">18</a>.</strong>   <img src="images/tick2.jpg" alt="Images" />   <strong>D</strong> is a correct statement about singletons.</p>
<p class="quep"><img src="images/times.jpg" alt="Images" />   <strong>A, B, C,</strong> and <strong>E</strong> are incorrect. <strong>A</strong> is simply incorrect. <strong>B</strong> is almost right; a singleton’s constructor can only be marked private. <strong>C</strong> is simply incorrect; a singleton usually has many methods. <strong>E</strong> is incorrect because, although you can implement a singleton using an enum, using an enum is not required. (OCP Objective 1.5)</p>
<p class="que-q1"><strong><a href="ch2.xhtml#ch2ans19" id="r_ch2ans19">19</a>.</strong>   <img src="images/tick2.jpg" alt="Images" />   <strong>A, E, F,</strong> and <strong>G</strong> are correct statements about immutable classes.</p>
<p class="quep"><img src="images/times.jpg" alt="Images" />   <strong>B</strong> is incorrect because immutable classes cannot have any setter methods. <strong>C</strong> is incorrect because immutable classes can also use constructors. <strong>D</strong> is incorrect because fields can be of mutable types, but they must be dealt with defensively. (OCP Objective 1.5)<span id="page_168" epub:type="pagebreak"></span></p>
</section>
</div>
</body>
</html>